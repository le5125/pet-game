<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é›»å­å¯µç‰©</title>

<!-- ========== CSS  ========== -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.tailwindcss.com"></script>

<!-- ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ CSS æ¨£å¼å€å¡Š START ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ -->
<style>
   /* ğŸ§± å…¨åŸŸè¨­å®šï¼šåŸºæœ¬é é¢æ ¼å¼èˆ‡é è¨­æ¨£å¼ */
html, body {
    height: 100%;               /* å…¨é æ»¿é«˜ */
    margin: 0;                  /* ç§»é™¤é è¨­é‚Šè· */
    padding: 0;                 /* ç§»é™¤é è¨­å…§è· */
    font-size: 48px;            /* å…¨ç«™åŸºç¤å­—é«”å¤§å°ï¼ˆå« icon ç”¨ï¼‰ */
    background-color: #fff;     /* é è¨­èƒŒæ™¯ç‚ºç™½è‰² */
    overflow: hidden;           /* é˜²æ­¢ç•«é¢æ²å‹• */
}

/* ğŸ”´ ä¸»è§’åœ“é»è§’è‰²æ¨£å¼ï¼ˆç”¨åœ–ç‰‡è¡¨ç¤ºï¼‰ */
.sprite {
  width: 400px;
  height: 400px;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
}

/* ğŸ”‹ ç‹€æ…‹æ¢åŸºç¤æ¨£å¼ï¼ˆç”¨æ–¼é£½è¶³ã€å¿«æ¨‚ã€æ¸…æ½”ç­‰ï¼‰ */
.status-bar {
    height: 10px;               /* ç‹€æ…‹æ¢é«˜åº¦ */
    border-radius: 5px;         /* åœ“è§’è¨­è¨ˆ */
    transition: width 0.3s ease;/* å¯¬åº¦è®ŠåŒ–åŠ å…¥å‹•ç•«éæ¸¡æ•ˆæœ */
}

/* ğŸ’¬ å°è©±æ³¡æ³¡æ¨£å¼ï¼ˆè§’è‰²èªªè©±ä½¿ç”¨ï¼‰ */

.speech-bubble {
    position: absolute;         /* è®“æ³¡æ³¡æµ®å‹•åœ¨è§’è‰²ä¸Šæ–¹ */
    background: white;          /* èƒŒæ™¯ç™½è‰² */
    border-radius: 10px;        /* åœ“è§’æ³¡æ³¡ */
    padding: 12px 20px;         /* å…§è·èª¿æ•´æ–‡å­—é–“è· */
    font-size: 36px;            /* æ–‡å­—å¤§å° */
    box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* é™°å½±æ•ˆæœ */
    white-space: nowrap;        /* å–®è¡Œä¸æ›è¡Œ */
    display: inline-block;      /* è‡ªå‹•å¯¬åº¦é¡¯ç¤º */
    opacity: 0;                 /* é è¨­éš±è—ï¼Œé€é JS æ§åˆ¶é¡¯ç¤º */
    transition: opacity 0.3s ease;       /* é¡¯ç¤ºèˆ‡éš±è—çš„å‹•ç•« */
    pointer-events: none;       /* ä¸å½±éŸ¿æ»‘é¼ é»æ“Š */
    top: -60px;                 /* å¾è§’è‰²é ‚ç«¯å¾€ä¸Šåç§» */
    left: 50%;                  /* æ°´å¹³ç½®ä¸­ */
    transform: translateX(-50%);/* æ°´å¹³ç§»å‹•ç½®ä¸­å°é½Š */
    max-width: 90vw;            /* æœ€å¤šä¸è¦è¶…å‡ºç•«é¢å¯¬åº¦ */
    word-break: break-word;            /* âœ… ä¸­æ–‡æœƒè‡ªå‹•æ–·è¡Œ */
    overflow: hidden;           /* è¶…å‡ºéƒ¨åˆ†éš±è— */
    text-overflow: ellipsis;    /* è¶…éåŠ ä¸Š ... */
}

/* ğŸ’¬ å°è©±æ³¡æ³¡ç®­é ­æ¨£å¼ï¼ˆä¸‰è§’å½¢æŒ‡å‘è§’è‰²ï¼‰ */
.speech-bubble:after {
    content: '';                            /* é¡¯ç¤ºç©ºå…§å®¹ç”¢ç”Ÿç®­é ­ */
    position: absolute;
    left: 50%;                              /* ç½®ä¸­ */
    bottom: -10px;                          /* å¾ä¸‹æ–¹å»¶ä¼¸ç®­é ­ */
    transform: translateX(-50%);            /* å°é½Šä¸­å¿ƒ */
    border-width: 10px 10px 0 10px;         /* ä¸Šæ–¹ä¸‰è§’å½¢ */
    border-style: solid;
    border-color: white transparent transparent transparent; /* ç™½è‰²ç®­é ­ */
}

/* â›³ walkï¼šæ¨¡æ“¬è§’è‰²å·¦å³æ–æ“ºï¼‹ä¸Šä¸‹å°å¹…ç§»å‹•ï¼Œè¡¨ç¾å‡ºã€Œèµ°è·¯ä¸­ã€çš„æ•ˆæœ */
@keyframes walk {
  0%, 100% { transform: translateX(0) translateY(0); }        /* èµ·é»èˆ‡çµ‚é»æ­¸ä½ */
  25%      { transform: translateX(5px) translateY(-2px); }   /* å¾®å¾€å³ä¸Š */
  50%      { transform: translateX(10px) translateY(0); }     /* æ›´å¾€å³ä½†å›ä¸­ç·š */
  75%      { transform: translateX(5px) translateY(2px); }    /* å¾€å³ä¸‹ */
}
/* ğŸ½ï¸ eatï¼šè§’è‰²å‚ç›´æ–¹å‘è¼•å¾®å½ˆè·³ï¼Œæ¨¡æ“¬ã€Œåƒæ±è¥¿æ™‚é»é ­ã€çš„æ•ˆæœ */
@keyframes eat {
  0%, 100% { transform: translateY(0); }                      /* é è¨­ä½ç½® */
  50%      { transform: translateY(5px); }                    /* å‘ä¸‹å£“ */
}
/* ğŸ® playï¼šå·¦å³æ—‹è½‰æ“ºå‹•ï¼Œæ¨¡æ“¬è§’è‰²ã€Œç©è€ä¸­ï¼Œèˆˆå¥®æ‰­å‹•ã€çš„æ•ˆæœ */
@keyframes play {
  0%, 100% { transform: rotate(0deg); }                       /* å›æ­¸åŸè§’åº¦ */
  25%      { transform: rotate(5deg); }                       /* å‘å³è½‰ */
  75%      { transform: rotate(-5deg); }                      /* å‘å·¦è½‰ */
}
/* ğŸ’¤ sleepï¼šè§’è‰²ç¡è¦ºæ™‚æœƒå¾®å¾®å·¦å³æ™ƒä¸¦ä¸Šä¸‹ç§»å‹•ï¼Œæ¨¡æ“¬å‘¼å¸æ„Ÿ */
@keyframes sleep {
  0%   { transform: rotate(0deg) translateY(0); }             /* éœæ­¢ */
  50%  { transform: rotate(5deg) translateY(5px); }           /* å¾®å¾®æ—‹è½‰èˆ‡æ²‰ä¸‹ */
  100% { transform: rotate(0deg) translateY(0); }             /* å›åˆ°åŸé» */
}
/* ğŸ’¤ sleepZzzï¼šä¸Šå‡æ¶ˆå¤±çš„ Zzz æ°£æ³¡å‹•ç•«ï¼Œç”¨ä¾†é¡¯ç¤ºåœ¨è§’è‰²æ—é‚Š */
@keyframes sleepZzz {
  0%   { opacity: 0; transform: translateY(0); }              /* é–‹å§‹éš±å½¢åœ¨åŸåœ° */
  50%  { opacity: 1; }                                        /* æ¼¸æ¼¸æµ®ç¾ */
  100% { opacity: 0; transform: translateY(-20px); }          /* ä¸Šå‡ä¸¦æ¶ˆå¤± */
}
/* ğŸ¬ ç‹€æ…‹é¡åˆ¥ï¼šè§’è‰²ç•¶å‰ç‹€æ…‹å°æ‡‰å‹•ç•«ï¼Œé€é JS å‹•æ…‹åŠ ä¸Š class */
.walking {
  animation: walk 0.5s infinite;/* ğŸš¶â€â™‚ï¸ walkingï¼šè§’è‰²æ­£åœ¨ç§»å‹•æ™‚åŠ ä¸Šï¼Œè§¸ç™¼ walk å‹•ç•« */
}
.eating {
  animation: eat 0.3s infinite;/* ğŸ” eatingï¼šè§’è‰²é€²é£Ÿä¸­ï¼Œè§¸ç™¼ eat å‹•ç•«ï¼ˆä¸Šä¸‹é»é ­ï¼‰ */
}
.playing {
  animation: play 0.5s infinite;/* ğŸª€ playingï¼šè§’è‰²ç©è€ä¸­ï¼Œè§¸ç™¼æ—‹è½‰å‹•ç•« */
}
.sleeping {
  animation: sleep 2s infinite;/* ğŸ›Œ sleepingï¼šè§’è‰²ç¡è‘—äº†ï¼Œè§¸ç™¼æ—‹è½‰ï¼‹ä¸‹æ²‰çš„ç¡è¦ºå‹•ç•« */
}
/* ğŸ’­ zzzï¼šæ­é…ç¡è¦ºç‹€æ…‹ï¼Œåœ¨è§’è‰²æ—é£„å‡º Zzz æ³¡æ³¡ï¼ˆéœ€æ”¾åœ¨è§’è‰²æ—é‚Šçš„ span æˆ– divï¼‰ */
.zzz {
  position: absolute;                    /* ç›¸å°æ–¼è§’è‰²å®¹å™¨å®šä½ */
  animation: sleepZzz 2s infinite;       /* æŒçºŒåŸ·è¡Œ Zzz å‹•ç•« */
  font-size: 80px;
  color: #666;                           /* æ·¡ç°è‰²ï¼Œé¿å…éæ–¼é¡¯çœ¼ */
}

/* ğŸ£ è§’è‰²å®¹å™¨ä½ç½®èˆ‡å‹•ç•«éæ¸¡ */
/* .chicken-containerï¼šä¸»è¦è§’è‰²å¤–æ¡†ï¼ŒåŒ…å«åœ–ç‰‡ã€å‹•ç•«ç­‰å…ƒç´ ï¼Œå›ºå®šç½®ä¸­ */
.chicken-container {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);      /* ç²¾æº–ç½®ä¸­ç•«é¢ */
  transition: all 0.3s ease;             /* ä»»æ„ä½ç½®æˆ–å¤§å°æ”¹è®Šæ™‚æ»‘é †éæ¸¡ */
  z-index: 20;                           /* åœ¨èƒŒæ™¯èˆ‡å ´æ™¯ä¸Šæ–¹ï¼Œé¿å…è¢«è“‹ä½ */
}

/* ğŸ— é£Ÿç‰©èˆ‡ç©å…·å…ƒç´ æ¨£å¼ï¼šæŠ•æ”¾å¾Œè§’è‰²å¯ä»¥äº’å‹•çš„ç‰©ä»¶ */

/* å…±ç”¨è¨­å®šï¼šçµ•å°å®šä½ï¼‹æ»‘é¼ è®Šæ‰‹ï¼‹ hover æ”¾å¤§å‹•ç•« */
.food-item,
.toy-item {
  position: absolute;                    /* æŠ•æ”¾åœ¨ç•«é¢ä»»æ„ä½ç½® */
}
/* é£Ÿç‰©å°ºå¯¸è¼ƒå°ï¼ˆä¾‹å¦‚é£¼æ–™ç²’ï¼‰ */
.food-item {
  width: 20px;
  height: 20px;
}
/* ç©å…·å°ºå¯¸ç•¥å¤§ï¼ˆä¾‹å¦‚çƒï¼‰ */
.toy-item {
  width: 30px;
  height: 30px;
}
/* æ»‘é¼ æ‡¸åœæ™‚è®Šå¤§ï¼Œå¸å¼•é»æ“Š */
.food-item:hover,
.toy-item:hover {
  transform: scale(1.2);
}

/* .poopï¼šè§’è‰²æ’ä¾¿å¾Œç”Ÿæˆï¼Œç‚ºä¸€å€‹å›ºå®šåœ–ç‰‡ï¼Œå‡ºç¾åœ¨ç•«é¢ä¸Šéš¨æ©Ÿä½ç½® */
.poop {
  width: 100px;
  height: 100px;
  background-image: url('https://i.imgur.com/n1wu20p.png'); /* å›ºå®šå¤§ä¾¿åœ–ç‰‡ URL */
  background-size: contain;             /* ä¾æ¯”ä¾‹ç¸®æ”¾åœ–ç‰‡å¡«æ»¿ */
  background-repeat: no-repeat;         /* ä¸é‡è¤‡è²¼åœ– */
  background-position: center;          /* åœ–ç‰‡ç½®ä¸­ */
  position: absolute;                   /* å¯ä»»æ„å®šä½åœ¨ç•«é¢ä¸Š */
  overflow: hidden;                     /* é¿å…å…§å®¹æº¢å‡ºå½±éŸ¿æ’ç‰ˆ */
  z-index: 25;                          /* ç¢ºä¿åœ¨è§’è‰²åº•ä¸‹ã€èƒŒæ™¯ä¹‹ä¸Š */
}
/* ğŸ§± èƒŒåŒ…æ ¼å­å®¹å™¨è¨­å®š */
/* ğŸ”¹ æ§åˆ¶æ•´å€‹èƒŒåŒ…çš„æ’åˆ—æ–¹å¼èˆ‡æ»¾å‹•ç¯„åœ */
#backpack-items {
  display: grid;                         /* ä½¿ç”¨ CSS Grid ä½ˆå±€ï¼Œæ–¹ä¾¿è£½ä½œæ ¼å­ç¶²æ ¼ */
  grid-template-columns: repeat(6, 1fr);/* æ¯åˆ— 6 æ ¼ï¼Œæ¯æ ¼å¹³å‡åˆ†é…å¯¬åº¦ */
  gap: 16px;                             /* æ¯æ ¼ä¹‹é–“çš„é–“è· */
  max-height: 600px;                     /* èƒŒåŒ…æœ€å¤§é«˜åº¦ï¼Œè¶…éæœƒå‡ºç¾æ²è»¸ */
  overflow-y: auto;                      /* å‚ç›´æ–¹å‘å¯æ²å‹•ï¼Œé©ç”¨é“å…·éå¤šæ™‚ */
}
/* ğŸ“¦ å–®ä¸€æ ¼å­çš„æ¨£å¼ï¼ˆå³æ¯å€‹èƒŒåŒ…æ ¼å­ï¼‰ */
.backpack-slot {
  width: 100px;                          /* æ¯æ ¼å¯¬åº¦å›ºå®š */
  height: 100px;                         /* æ¯æ ¼é«˜åº¦å›ºå®š */
  border: 2px solid #999;                /* ç°è‰²é‚Šæ¡† */
  border-radius: 8px;                    /* é‚Šæ¡†åœ“è§’ */
  background-color: #fdfdfd;             /* èƒŒæ™¯æ·¡ç°ç™½ */
  display: flex;                         /* ä½¿ç”¨ Flex å°é½Šå…§å®¹ */
  justify-content: center;              /* æ°´å¹³ç½®ä¸­ */
  align-items: center;                  /* å‚ç›´ç½®ä¸­ */
  font-size: 24px;                       /* å…§å®¹æ–‡å­—å¤§å°ï¼ˆè‹¥æœ‰é è¨­å…§å®¹ï¼‰ */
  font-weight: bold;                     /* ç²—é«” */
  position: relative;                    /* ç‚ºäº†è®“ item-count èƒ½å®šä½åœ¨å³ä¸‹è§’ */
}

/* ğŸ”¢ é¡¯ç¤ºè©²ç‰©å“æ•¸é‡çš„å³ä¸‹è§’å°æ¨™ç±¤ */
.item-count {
  position: absolute;                    /* å®šä½åœ¨æ ¼å­å³ä¸‹è§’ */
  bottom: 4px;
  right: 6px;
  font-size: 18px;                       /* æ•¸å­—å­—é«”ç¨å¾®å° */
  background-color: rgba(0,0,0,0.6);     /* é»‘è‰²åŠé€æ˜åº•è‰²ï¼Œé¿å…è¢«èƒŒæ™¯å¹²æ“¾ */
  color: white;                          /* ç™½å­—é¡¯ç¤ºæ•¸é‡ */
  padding: 2px 6px;                      /* é©åº¦å…§è·ï¼Œç¾è§€åœ“è§’æ•ˆæœ */
  border-radius: 6px;
}
/* ğŸ’ èƒŒåŒ…æ¨¡æ…‹æ¡†å‰å‰æ¨£å¼ */
#backpack-modal .close-button i {
  position: absolute;
  top: 12px;
  right: 12px;
  font-size: 100px;
  color: #555;
  background: none;
  border: none;
  cursor: pointer;
  z-index: 10;
  transition: color 0.2s;
}

#backpack-modal .close-button:hover i {
  color: #e11d48;
}

/* ğŸ¯ æ¢éšªæ¨¡æ…‹æ¡†å…§å®¹å¯¬åº¦èª¿æ•´ï¼ˆåœ°é»é¸æ“‡ç”¨ï¼‰ */
/* ğŸ§­ æ§åˆ¶ #explore-modal è£¡çš„å…§å®¹å¤§å°èˆ‡æ’ç‰ˆ */
#explore-modal .modal-content {
  width: 800px;                          /* å›ºå®šå¯¬åº¦ï¼Œä¹Ÿå¯è¦–éœ€æ±‚èª¿æ•´ */
  height: auto;                          /* é«˜åº¦è‡ªå‹•æ’é–‹ */
  max-width: 90vw;                       /* è¡Œå‹•è£ç½®ä¸‹ä¸è¶…å‡ºç•«é¢å¯¬åº¦ */
  padding: 32px;                         /* å…§è·å¢å¤§ï¼Œè®“å…§å®¹ä¸è²¼é‚Š */
}
/* æ¢éšªæ¨¡æ…‹æ¡†ä¸­çš„æ¨™é¡Œç½®ä¸­é¡¯ç¤º */
#explore-modal .modal-content h2 {
  text-align: center;
}

/* æ¢éšªæ¨¡æ…‹æ¡†ä¸­çš„æŒ‰éˆ•æ¨£å¼ï¼ˆå¦‚ä¸‰å€‹åœ°é»ï¼‰ */
#explore-modal .modal-content button {
  font-size: 80px;                       /* å­—å¤§ä¸€é»ï¼Œæ–¹ä¾¿é»æ“Š */
  padding: 40px;                         /* åŠ å¤§æŒ‰éˆ•ç¯„åœï¼Œå¢å¼·å¯é»æ“Šæ€§ */
}

/* ğŸ æ¢éšªçå‹µæ¨¡æ…‹æ¡†è¨­å®šï¼ˆç•¶æ¢éšªçµæŸé¡¯ç¤ºç²å¾—é“å…·ï¼‰ */
#explore-reward-modal .modal-content {
  width: 1200px;                          /* ç•¥å°æ–¼æ¢éšªåœ°é»é¸å–® */
  height: auto;                          /* é«˜åº¦æ ¹æ“šå…§å®¹èª¿æ•´ */
}
/* âœ¨ è‡ªè¨‚æ¢éšªæ¨¡æ…‹æ¡†çš„å‰å‰æ¨£å¼ */
#explore-modal .close-button i {
  position: absolute;
  top: 12px;              /* ä½ å¯ä»¥èª¿æ•´é€™è£¡ä¸Šä¸‹ä½ç½® */
  right: 12px;            /* ä½ å¯ä»¥èª¿æ•´é€™è£¡å·¦å³ä½ç½® */
  font-size: 100px;        /* èª¿æ•´å¤§å°ï¼ˆè¶Šå¤§è¶Šæ˜é¡¯ï¼‰ */
  color: #555;            /* é è¨­é¡è‰² */
  background: none;       /* ç§»é™¤èƒŒæ™¯ */
  border: none;           /* ç§»é™¤é‚Šæ¡† */
  cursor: pointer;        /* æ»‘é¼ è®Šæ‰‹æŒ‡ */
  z-index: 10;            /* ç¢ºä¿åœ¨æœ€ä¸Šå±¤ */
  transition: color 0.2s;
}

#explore-modal .close-button:hover {
  color: #e11d48;         /* hover æ™‚è®Šç´…è‰²ï¼ˆTailwind red-600ï¼‰ */
}

/* ğŸ” å¯µç‰©å ´æ™¯ä¸»è¦å€åŸŸèƒŒæ™¯å®¹å™¨ */
/* ğŸ‘‡ æ§åˆ¶æ•´å€‹éŠæˆ²ç•«é¢çš„èƒŒæ™¯åœ–å‘ˆç¾èˆ‡è¦†è“‹æ–¹å¼ */
.pet-area {
  position: fixed;                       /* å›ºå®šåœ¨æ•´å€‹ç•«é¢ä¸éš¨æ»¾å‹•ç§»å‹• */
  top: 0;
  left: 0;
  width: 100vw;                          /* å¯¬åº¦ç­‰æ–¼æ•´å€‹è¦–çª—å¯¬åº¦ */
  height: 100vh;                         /* é«˜åº¦ç­‰æ–¼æ•´å€‹è¦–çª—é«˜åº¦ */
  background-size: cover;               /* èƒŒæ™¯åœ–æ”¾å¤§ç¸®å°ä»¥å®Œå…¨è¦†è“‹ç•«é¢ */
  background-position: center;          /* èƒŒæ™¯åœ–ç½®ä¸­ */
  background-repeat: no-repeat;         /* ä¸é‡è¤‡è²¼åœ–ï¼ˆå–®å¼µèƒŒæ™¯ï¼‰ */
  z-index: 0;                            /* æ”¾åœ¨æœ€åº•å±¤ï¼Œå…¶ä»–ç‰©ä»¶è“‹åœ¨ä¸Šé¢ */
  overflow: hidden;                     /* å¤šå‡ºçš„å…§å®¹ä¸é¡¯ç¤ºï¼Œé¿å…ç•«é¢ç ´ç‰ˆ */
  position: relative;                   /* ç‚ºå…§éƒ¨çµ•å°å®šä½å…ƒä»¶æä¾›å®šä½åƒè€ƒ */
}


/* ğŸ‘¤ ç©å®¶è³‡è¨Šç¾¤ï¼ˆå·¦ä¸Šè§’ï¼‰ */
.info-panel {
  position: absolute;           /* å›ºå®šä½ç½®ï¼Œä¸å—å…¶ä»–å…ƒç´ å½±éŸ¿ */
  top: 10px;                    /* è·é›¢ç•«é¢é ‚ç«¯ 10px */
  left: 10px;                   /* è·é›¢å·¦å´ 10px */
  right: 10px;                  /* å¯æ­é… flex æ’é–‹æ•´å€‹å¯¬åº¦ */
  z-index: 9999;                /* ç–Šåœ¨æœ€ä¸Šå±¤ï¼Œé¿å…è¢«é®æ“‹ */
  display: flex;                /* å•Ÿç”¨ flex æ’åˆ— */
  flex-direction: row;         /* å­é …ç›®æ©«å‘æ’åˆ— */
  align-items: center;         /* å­å…ƒç´ å‚ç›´ç½®ä¸­ */
  gap: 12px;                    /* å­å…ƒç´ ä¹‹é–“çš„è·é›¢ */
  transform: scale(1);         /* æ•´é«”ç¸®æ”¾å¤§å°ï¼ˆä½ å¯ä»¥èª¿æ•´æ¯”ä¾‹ï¼‰ */
  transform-origin: top left;  /* ç¸®æ”¾åŸºæº–é»ï¼šå·¦ä¸Šè§’ */
  background: #fff;            /* ç™½è‰²èƒŒæ™¯ */
  border-radius: 999px;        /* å…¨åœ“è§’ â†’ å½¢æˆæ©¢åœ“ */
  padding: 6px 16px;           /* ä¸Šä¸‹ 6pxã€å·¦å³ 16px çš„å…§è· */
  box-shadow: 0 0 6px rgba(0,0,0,0.1); /* é™°å½±å¢åŠ ç«‹é«”æ„Ÿ */
}

/* å·¦é‚Šç­‰ç´šåœ“ç’° */
.level-circle {
  width: 100px;
  height:100px;
  margin-top: -30px;   /* âœ… å¾€ä¸Šæ‹‰ä¸€é» */
  margin-left: 0px;   /* âœ… å¾€å³æ¨ä¸€é» */
}

.level-circle-svg {
  width: 130px;       /* SVG å¯¬åº¦ */
  height: 130px;      /* SVG é«˜åº¦ */
}

.bg {
  fill: none;         /* ç„¡å¡«è‰² */
  stroke: #eee;       /* æ·ºç°è‰²å¤–æ¡†åœ“åœˆ */
  stroke-width: 3;    /* ç·šæ¢å¯¬åº¦ */
}

.progress {
  stroke: orange;     /* ç¶“é©—æ¢é¡è‰² */
  stroke-width: 3;
  fill: none;
  transform: rotate(0deg);       /* ä¸æ—‹è½‰ï¼ˆä¿ç•™ï¼‰ */
  transform-origin: center;
}
.level-text {
  font-size: 10px;
  fill: black;
  font-weight: bold;
}

.level-number {
  font-size: 10px;
  fill: black;
  font-weight: bold;
}

.level-label {
  transform: translateY(5px) scale(1.3); /* è®“ Lv + æ•¸å­—æ•´é«”å¾€ä¸‹ç§»å‹•ï¼‹æ”¾å¤§ */
  transform-origin: center;
}
.center-info {
  display: flex;
  flex-direction: column;
  justify-content: center;
 
}

.name-row {
  display: flex;
  align-items: center;
  gap: 6px;                      /* åå­—èˆ‡ç­†åœ–ç¤ºä¹‹é–“é–“è· */
}

#pet-name-display {
  font-weight: bold;
  font-size: 36px;
  margin-left: 20px;   /* âœ… å¾€å³æ¨ä¸€é» */
}

#rename-btn {
  background: none;
  border: none;
  color: #555;
  font-size: 36px;
  cursor: pointer;
}

.status-row {
  font-size: 36px;
  color: #444;
  margin-top: 20px;     /* ğŸ‘‰ å¾€ä¸‹ç§»å‹• */
  margin-left: 20px;   /* ğŸ‘‰ å¾€å³ç§»å‹• */
}

.coin-box {
  display: flex;
  align-items: center;
  justify-content: center;
  border: 2px solid orange;
  border-radius: 20px;      /* å¤–æ¡†åœ“è§’ */
  padding: 4px 10px;        /* ä¸Šä¸‹ 4pxã€å·¦å³ 10px å…§è· */
  color: orange;
  font-weight: bold;
  font-size: 36px;
  margin-left: auto;   /* è®“å®ƒé å³ï¼ˆå¿…è¦ï¼‰*/
  margin-top: -20px;    /* â†‘ å¾€ä¸Šç§»ï¼ˆå¯ä¾éœ€è¦å¾®èª¿ï¼‰ */
}

#weather-toggle {
  position: fixed;       /* è®“å®ƒå›ºå®šåœ¨ç•«é¢ä¸Š */
  top: 200px;         /* å¾€ä¸Šç•™å‡ºç©ºé–“ï¼Œé¿å…è¢«æœ€ä¸‹æ–¹æŒ‰éˆ•ç¾¤æ“‹ä½ */
  left: 40px;            /* å·¦é‚Šé‚Šè· */
  color: orange;
  font-size: 80px;
  cursor: pointer;
  z-index: 9999;         /* ç¢ºä¿åœ¨æœ€ä¸Šå±¤ï¼Œä¸è¢«è“‹ä½ */
}

/* ğŸ›ï¸ ç‹€æ…‹æ¢ç¾¤ï¼ˆå³ä¸Šè§’ï¼‰ */

/* æ•´é«”åœ“åœˆç‹€æ…‹å€å¡Šçš„æ¨£å¼è¨­å®š */
.status-circles {
  transform: scale(0.9);     /* å°‡æ•´å€‹å€å¡Šç¸®å° 90% */
  gap: 10px;                  /* æ¯å€‹åœ“åœˆä¹‹é–“çš„é–“è· */
  margin-left: auto;         /* âœ… é—œéµï¼šè®“æ•´å¡Šç‹€æ…‹åœ“åœˆé å³å°é½Š */
}

/* æ¯å€‹åœ“åœˆåŒ…è£å®¹å™¨çš„åŸºæœ¬æ¨£å¼ */
.circle-wrapper {
  text-align: center;        /* è®“å…§éƒ¨çš„æ–‡å­—ç½®ä¸­ */
}

/* è¨­å®š SVG å°ºå¯¸å¤§å°ï¼ˆåœ“åœˆå¤§å°æ§åˆ¶åœ¨é€™è£¡ï¼‰ */
.circle-svg {
  width: 110px;              /* SVG å¯¬åº¦ */
  height: 110px;             /* SVG é«˜åº¦ */
}

/* ç°è‰²èƒŒæ™¯åœ“åœˆæ¨£å¼ */
.circle-bg {
  stroke: #e5e7eb;           /* ç°è‰²é‚Šæ¡† */
  stroke-width: 10;          /* åœ“åœˆç²—ç´° */
  fill: none;                /* ä¸å¡«è‰² */
}

/* å½©è‰²é€²åº¦æ¢åœ“åœˆæ¨£å¼ï¼ˆå‰æ™¯åœˆï¼‰ */
.circle-bar {
  stroke-width: 10;          /* åœ“åœˆç²—ç´° */
  fill: none;                /* ä¸å¡«è‰² */
  transform: rotate(-90deg); /* è®“é€²åº¦å¾ä¸Šæ–¹é–‹å§‹ç•«åœ“ */
  transform-origin: 50% 50%; /* æ—‹è½‰ä¸­å¿ƒè¨­å®šç‚ºåœ“å¿ƒ */
  stroke-linecap: round;     /* ç·šå°¾æ˜¯åœ“é ­ */
}

/* ä¸‹æ–¹çš„ç™¾åˆ†æ¯”æ•¸å­—æ¨£å¼ */
.status-value {
  font-size: 32px;           /* å­—é«”å¤§å° */
  font-weight: bold;         /* ç²—é«” */
  margin-top: 4px;           /* åœ“åœˆå’Œæ•¸å­—ä¹‹é–“çš„è·é›¢ */
}

/* åœ“åœˆæ­£ä¸­å¤®é¡¯ç¤ºçš„ã€Œé£¢é¤“ / å¿«æ¨‚ / ç²¾åŠ› / æ¸…æ½”ã€æ–‡å­—æ¨£å¼ */
.circle-title {
  font-size: 32px;           /* åœ“å…§æ–‡å­—å¤§å° */
  fill: #333;                /* æ·±ç°è‰²å­—é«” */
  font-weight: bold;         /* ç²—é«” */
  pointer-events: none;      /* ç¦æ­¢æ»‘é¼ äº‹ä»¶ï¼ˆé¿å…å½±éŸ¿æ“ä½œï¼‰ */
}

/* å„å€‹ç‹€æ…‹å°æ‡‰çš„åœ“åœˆé€²åº¦é¡è‰² */
.hunger .circle-bar      { stroke: red; }
.happiness .circle-bar   { stroke: orange; }
.energy .circle-bar      { stroke: blue; }
.cleanliness .circle-bar { stroke: green; }

/* å„å€‹ç‹€æ…‹å°æ‡‰çš„ç™¾åˆ†æ¯”æ–‡å­—é¡è‰² */
.hunger .status-value      { color: red; }
.happiness .status-value  { color: orange; }
.energy .status-value      { color: blue; }
.cleanliness .status-value { color: green; }


/* ğŸ§  åŠŸèƒ½æŒ‰éˆ•ç¾¤ï¼šåº•éƒ¨ç½®ä¸­ */
/* é€™æ˜¯æ§åˆ¶åŠŸèƒ½æŒ‰éˆ•çš„ä¸»è¦å®¹å™¨ï¼Œä¾‹å¦‚é¤µé£Ÿã€æ¸…æ½”ã€ç¡è¦ºç­‰è¡Œç‚ºæŒ‰éˆ• */
.control-panel {
  position: absolute;              /* çµ•å°å®šä½ï¼šå›ºå®šåœ¨ç•«é¢ä¸Š */
  bottom: 20px;                    /* é›¢ç•«é¢åº•éƒ¨ 20px */
  left: 50%;                       /* å¾ç•«é¢æ°´å¹³ä¸­é–“é–‹å§‹ */
  transform: translateX(-50%)      /* æ°´å¹³ç½®ä¸­ */ 
             scale(0.3);           /* æ•´é«”ç¸®å°ç‚º 30% å°ºå¯¸ */
  transform-origin: bottom center; /* ä»¥åº•éƒ¨ä¸­å¿ƒç‚ºç¸®æ”¾åŸé»ï¼Œä¸è·‘ç‰ˆ */
  display: grid;                   /* ä½¿ç”¨ CSS Grid æ’åˆ—å¤šå€‹æŒ‰éˆ• */
  grid-template-columns: repeat(4, minmax(60px, 1fr)); /* å»ºç«‹ 4 æ¬„ï¼ŒæŒ‰éˆ•å¯¬æœ€å°‘ 60px */
  gap: 8px;                        /* æ¯å€‹æŒ‰éˆ•ä¹‹é–“é–“è·ç‚º 8px */
  z-index: 50;                     /* è“‹éèƒŒæ™¯ã€è§’è‰²ã€åœ°åœ– */
}
/* ğŸŸ¢ ç‹€æ…‹æ¢æ¨£å¼å¾®èª¿ */
/* ç”¨æ–¼æ‰€æœ‰é¡¯ç¤ºç‹€æ…‹çš„é€²åº¦æ¢ï¼ˆå¦‚é£½è¶³ã€å¿«æ¨‚ç­‰ï¼‰ï¼Œä½¿å…¶æ›´ç´°ç·»ç¾è§€ */
.status-bar {
  height: 6px;                    /* ç‹€æ…‹æ¢é«˜åº¦ç‚º 6pxï¼Œæ¯”åŸæœ¬æ›´ç´° */
  border-radius: 3px;             /* åœ“è§’ç‚º 3pxï¼Œè®“æ¢ç‹€å¤–è§€æŸ”å’Œ */
  transition: width 0.3s ease;   /* å¯¬åº¦è®ŠåŒ–æ™‚æ·»åŠ æ»‘é †å‹•ç•« */
}
/* ğŸŸ  åœ“å½¢æŒ‰éˆ•çµ±ä¸€è¨­å®š */
/* ä¸‹æ–¹æ˜¯ä¸€æ•´å¥—æŒ‰éˆ•å€å¡Šæ¨£å¼ï¼Œè®“åº•éƒ¨æ§åˆ¶æŒ‰éˆ•å¤–è§€ä¸€è‡´ã€ç¾è§€ */

/* ğŸ“¦ å¤–å±¤å®¹å™¨ï¼šå›ºå®šåœ¨åº•éƒ¨ä¸­é–“ï¼ŒåŒ…ä½æ•´æ’æŒ‰éˆ•ï¼ˆå«æŒ‰éˆ•åˆ—ï¼‰ */
.button-wrapper {
  position: fixed;                /* å›ºå®šå®šä½ï¼Œæ»¾å‹•ç•«é¢æ™‚ä¸æœƒå‹• */
  bottom: 180px;                  /* é›¢åº•éƒ¨ 180pxï¼ˆé¿å…é®ä½ log è¦–çª—ï¼‰ */
  left: 50%;                      /* å¾ç•«é¢ä¸­é–“é–‹å§‹ */
  transform: translateX(-50%);   /* æ°´å¹³ç½®ä¸­ */
  z-index: 99;                    /* å±¤ç´šè¼ƒé«˜ï¼Œé¡¯ç¤ºæ–¼æœ€ä¸Šå±¤ */
  display: flex;                  /* Flex æ’ç‰ˆï¼ˆæ©«æ’ï¼‰ */
  justify-content: center;       /* æ‰€æœ‰å…§å®¹ç½®ä¸­å°é½Š */
  width: 100%;                   /* æ•´æ¢å¯¬åº¦ç‚º 100%ï¼Œç¢ºä¿ç½®ä¸­ */
}
/* â­• å…­é¡†åŠŸèƒ½æŒ‰éˆ•æ’æˆä¸€åˆ—çš„å®¹å™¨ */
.button-row {
  display: flex;                  /* ä½¿ç”¨ Flex æ’ç‰ˆï¼ˆæ©«å‘ï¼‰ */
  flex-wrap: nowrap;             /* ä¸å…è¨±è‡ªå‹•æ›è¡Œ */
  gap: 12px;                      /* æŒ‰éˆ•ä¹‹é–“é–“è· 12px */
  justify-content: center;       /* æ‰€æœ‰æŒ‰éˆ•ç½®ä¸­ */
  align-items: center;           /* å‚ç›´ç½®ä¸­ */
  transform: scale(0.9)
}
/* ğŸ¯ æ¯é¡†åœ“å½¢æŒ‰éˆ•çš„çµ±ä¸€å¤–è§€è¨­å®š */
.btn-circle {
  width: 140px;                   /* æŒ‰éˆ•å¯¬åº¦ */
  height: 140px;                  /* æŒ‰éˆ•é«˜åº¦ï¼ˆèˆ‡å¯¬ä¸€è‡´ï¼Œç¶­æŒåœ“å½¢ï¼‰ */
  border-radius: 50%;            /* å®Œæ•´åœ“è§’ï¼Œè®Šæˆåœ“å½¢ */
  padding: 0;                     /* å–æ¶ˆå…§è·ï¼Œé¿å…å…§å®¹éŒ¯ä½ */
  display: flex;                 /* ä½¿ç”¨ Flex è®“å…§å®¹ç½®ä¸­ */
  flex-direction: column;        /* å…§å®¹å‚ç›´æ’åˆ—ï¼šä¸Š iconã€ä¸‹æ–‡å­— */
  justify-content: center;       /* å‚ç›´ç½®ä¸­ */
  align-items: center;           /* æ°´å¹³ç½®ä¸­ */
  color: white;                  /* å­—é«”é¡è‰²ç‚ºç™½è‰²ï¼ˆä¸€èˆ¬æ­é…å½©è‰²èƒŒæ™¯ï¼‰ */
  font-weight: bold;             /* å­—é«”åŠ ç²— */
  box-shadow: 0 4px 6px rgba(0,0,0,0.1); /* é™°å½±è®“æŒ‰éˆ•æœ‰ç«‹é«”æ„Ÿ */
  text-align: center;            /* æ–‡å­—ç½®ä¸­å°é½Š */
}
/* â¬†ï¸ æŒ‰éˆ•å…§çš„åœ–ç¤ºï¼ˆé€šå¸¸ä½¿ç”¨ Font Awesomeï¼‰ */
.btn-circle i {
  font-size: 64px;               /* åœ–ç¤ºå¤§å° */
  margin-bottom: 6px;            /* åœ–ç¤ºèˆ‡æ–‡å­—ä¹‹é–“é–“è· */
  display: block;                /* ç¨ç«‹ä¸€è¡Œ */
}
/* â¬‡ï¸ æŒ‰éˆ•å…§çš„æ–‡å­—èªªæ˜ï¼ˆåœ¨åœ–ç¤ºä¸‹æ–¹ï¼‰ */
.btn-circle span {
  font-size: 42px;               /* æ–‡å­—å¤§å° */
  line-height: 1;                /* è¡Œé«˜ç‚º 1ï¼ˆä¸åŠ é¡å¤–ç©ºç™½ï¼‰ */
  display: block;                /* ç¨ç«‹ä¸€è¡Œ */
}
/* ğŸ“± éŸ¿æ‡‰å¼è¨­è¨ˆï¼šæ‰‹æ©Ÿè£ç½®ä¸‹æŒ‰éˆ•ç¸®å°èª¿æ•´ */
@media (max-width: 768px) {
  .btn-circle {
    width: 80px;                 /* ç¸®å°å¯¬åº¦ */
    height: 80px;                /* ç¸®å°é«˜åº¦ */
  }

  .btn-circle i {
    font-size: 24px;            /* åœ–ç¤ºç¸®å° */
    margin-bottom: 4px;         /* åœ–ç¤ºèˆ‡æ–‡å­—é–“è·ç¸®å° */
  }

  .btn-circle span {
    font-size: 16px;            /* æ–‡å­—ç¸®å° */
  }
}

    /* ğŸªŸ æ‰€æœ‰æ¨¡æ…‹æ¡†çš„åŸºæœ¬è¨­å®šï¼ˆåŒ…å«ä¸€èˆ¬ modalã€è£æ‰® costume-modalã€å¾©æ´» revive-modalï¼‰ */
.modal, .costume-modal, .revive-modal {
    display: none;                          /* é è¨­éš±è—ï¼Œé€é JS ä¾†é¡¯ç¤º */
    position: fixed;                        /* å›ºå®šåœ¨ç•«é¢ä¸Šä¸æœƒè¢«æ²å‹•å½±éŸ¿ */
    top: 0;
    left: 0;
    width: 100%;                            /* å…¨ç•«é¢å¯¬åº¦ */
    height: 100%;                           /* å…¨ç•«é¢é«˜åº¦ */
    background-color: rgba(0,0,0,0.5);      /* èƒŒæ™¯ç‚ºåŠé€æ˜é»‘è‰² */
    z-index: 1000;                          /* å±¤ç´šå¾ˆé«˜ï¼Œè“‹ä½æ‰€æœ‰ç•«é¢ */
    justify-content: center;               /* å°‡è£¡é¢çš„å…§å®¹æ°´å¹³ç½®ä¸­ */
    align-items: center;                   /* å°‡è£¡é¢çš„å…§å®¹å‚ç›´ç½®ä¸­ */
}

/* âœï¸ æ‰€æœ‰æ–‡å­—è¼¸å…¥æ¡†çš„æ¨£å¼ï¼ˆå¦‚å‘½åã€è¼¸å…¥æŒ‡ä»¤ç­‰ï¼‰ */
input[type="text"] {
    font-size: 48px; /* ä½¿ç”¨å¤§å­—ï¼Œé©åˆè§¸æ§è£ç½®è¼¸å…¥ */
}

/* ğŸ“¦ æ‰€æœ‰æ¨¡æ…‹æ¡†å…§éƒ¨çš„å…§å®¹å€ï¼ˆå³ modal-contentï¼‰ */
.modal-content {
    position: relative;                    /* ç‚ºäº†è®“å³ä¸Šè§’é—œé–‰å‰å‰èƒ½ç›¸å°å®šä½ */
    background-color: white;              /* èƒŒæ™¯ç‚ºç™½è‰² */
    padding: 40px;                         /* å…§è· */
    border-radius: 20px;                   /* é‚Šè§’åœ“å¼§ */
    width: 800px;                          /* å›ºå®šå¯¬åº¦ç‚ºæ©«å‘é•·æ–¹å½¢ */
    height: 600px;                         /* å›ºå®šé«˜åº¦ï¼Œå¯å®¹ç´å…§å®¹ */
    overflow-y: auto;                      /* è‹¥å…§å®¹å¤ªå¤šå‰‡å¯å‚ç›´æ»¾å‹• */
    max-width: 90%;                        /* æ‰‹æ©Ÿå¯¬åº¦é™åˆ¶æœ€å¤§ 90% */
    font-size: 48px;                       /* å…§æ–‡å¤§å­—é«”é¡¯ç¤º */
}


/* ğŸ·ï¸ åç¨±é¡¯ç¤ºå€å®¹å™¨ï¼ˆå¯µç‰©å‘½åã€ç©å®¶åç¨±ï¼‰ */
.name-container {
    display: flex;                         /* è®“å…§å®¹æ©«å‘å°é½Š */
    align-items: center;                   /* å‚ç›´ç½®ä¸­å°é½Š */
    justify-content: center;               /* æ°´å¹³ç½®ä¸­å°é½Š */
}



/* ğŸ”´ æŒ‰éˆ•æç¤ºå‹•ç•«ï¼ˆæœƒå¤–æ¡†é–ƒçˆå¸å¼•æ³¨æ„ï¼‰ */
@keyframes buttonPulse {
    0%   { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }  /* åˆå§‹ï¼šç´…è‰²é™°å½±å…§ç¸® */
    70%  { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); } /* æ“´å¤§é™°å½±è®Šé€æ˜ */
    100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }    /* å›åˆ°åˆå§‹ */
}

/* ğŸ”´ è®“æŒ‰éˆ•æœ‰é–ƒçˆæç¤ºæ•ˆæœçš„é¡åˆ¥ */
.pulse-button {
    animation: buttonPulse 2s infinite;    /* æ¯å…©ç§’é–ƒçˆä¸€æ¬¡ */
}

/* ğŸŒ§ï¸ é–ƒé›»ç‰¹æ•ˆ */
.lightning-flash {
  position: absolute;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: white;
  opacity: 0.8;
  z-index: 1000;
  transition: opacity 0.2s ease-out;
  pointer-events: none; /* ä¸é˜»æ“‹é»æ“Š */
}


/* ğŸŒ§ï¸ é›¨æ»´å‹•ç•«å–®ä¸€é›¨æ»´è¨­å®šï¼ˆä½ç½®ã€å¤–è§€ã€å‹•ç•«ï¼‰ */
.raindrop {
    position: absolute;                   /* æ¯æ»´é›¨æ˜¯çµ•å°å®šä½ */
    top: 0;                               /* å¾ç•«é¢æœ€ä¸Šæ–¹é–‹å§‹ä¸‹ */

    /* âœ… å¤–è§€è¨­å®š */
    width: 12px;                           /* é›¨æ»´å¯¬åº¦ï¼ˆè®Šç²—ï¼‰ */
    height: 20px;                         /* é›¨æ»´é«˜åº¦ï¼ˆè®Šé•·ï¼‰ */
     background-color: rgba(255, 255, 255, 0.25); /* âœ… ç™½è‰² + 25% é€æ˜ */
     
    /* âœ… åŸ·è¡Œä¸‹è½å‹•ç•«ï¼ˆä¸‹åˆ°ç•«é¢åº•éƒ¨ï¼‰ */
    animation: rainFall 0.6s linear infinite;
}

/* ğŸŒ§ï¸ é›¨æ»´å‹•ç•«é—œéµå½±æ ¼ï¼šå¾€ä¸‹è½åˆ°åº• */
@keyframes rainFall {
    to {
        transform: translateY(100vh);     /* é›¨æ»´è½åˆ°åº•éƒ¨ */
    }
}


/* âœ… é›¨æ»´å‹•ç•«ï¼šå¾€ä¸‹ç§»å‹•ç•«é¢é«˜åº¦ */
@keyframes rainFall {
    to {
        transform: translateY(100vh);
    }
}
/* â­ å¤œæ™šæ˜Ÿæ˜Ÿå‹•ç•«ï¼ˆé–ƒçˆï¼‰ */
.star {
  position: absolute;             /* æ¯ä¸€é¡†æ˜Ÿæ˜Ÿéƒ½æ˜¯çµ•å°å®šä½ */
  width: 12px;                     /* æ˜Ÿæ˜Ÿå¯¬åº¦ */
  height: 8px;                    /* æ˜Ÿæ˜Ÿé«˜åº¦ */
  background-color: white;        /* ç™½è‰²æ˜Ÿæ˜Ÿ */
  border-radius: 50%;             /* åœ“å½¢ */
  opacity: 0.8;                   /* åˆå§‹é€æ˜åº¦ */
  animation: twinkle 2s infinite ease-in-out; /* åŠ å…¥é–ƒçˆå‹•ç•« */
}

/* â­ æ˜Ÿæ˜Ÿé–ƒçˆå‹•ç•«é—œéµå½±æ ¼ */
@keyframes twinkle {
  0%, 100% { opacity: 0.3; }      /* é–ƒçˆï¼šæ·¡å‡º */
  50% { opacity: 1; }             /* é–ƒçˆï¼šæœ€äº® */
}

/* â­ æ˜Ÿæ˜Ÿå®¹å™¨åªåœ¨ç•«é¢ä¸ŠåŠéƒ¨é¡¯ç¤º */
#starsContainer {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;                  /* æ»¿ç‰ˆå¯¬åº¦ */
  height: 50vh;                 /* åªä½”è¢å¹•ä¸ŠåŠéƒ¨ */
  overflow: hidden;             /* è¶…å‡ºéƒ¨åˆ†ä¸é¡¯ç¤º */
  pointer-events: none;         /* ä¸æ“‹ä½é»æ“Šæ“ä½œ */
  z-index: 1;                   /* é¡¯ç¤ºåœ¨èƒŒæ™¯åœ–ä¸Šå±¤ã€è§’è‰²ä¸‹å±¤ */
}

/* ğŸŒ™ æœˆäº®åœ–ç¤ºï¼ˆç½®ä¸­é¡¯ç¤ºåœ¨è¢å¹•ä¸Šæ–¹ï¼‰ */
#moon {
  position: absolute;
  top: 200px;                     /* é›¢ä¸Šæ–¹ä¸€æ®µè·é›¢ */
  left: 50%;                     /* å¾ä¸­é–“é–‹å§‹ */
  transform: translateX(-50%);   /* ç½®ä¸­å°é½Š */
  width: 240px;
  height: 240px;
  background-image: url('https://i.imgur.com/Ds6mk6p.png'); /* å¯æ›ä½ å–œæ­¡çš„æœˆäº®åœ– */
  background-size: contain;
  background-repeat: no-repeat;
  z-index: 2;                    /* é¡¯ç¤ºåœ¨æ˜Ÿæ˜Ÿä¹‹ä¸Š */
  opacity: 0.9;
}

 /* ======================================
ğŸ”¹ åº•éƒ¨æ§åˆ¶æŒ‰éˆ•æ¨£å¼ï¼ˆèŠå¤©å®¤ / æ—¥èªŒï¼‰
====================================== */
#toggle-log-btn,
#chat-toggle-btn {
  width: 100%;
  color: white;
  font-size: 60px;
  padding: 24px 0;
  border: none;
  border-radius: 0;
  box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
}

#toggle-log-btn {
  background-color: #3b82f6; /* è—è‰² */
}

#chat-toggle-btn {
  background-color: #ec4899; /* ç²‰ç´… */
}

/* ======================================
ğŸ“‹ æ—¥èªŒæŠ½å±œæ¨£å¼
====================================== */
#log-drawer {
  position: fixed;
  bottom: -100%;
  left: 0;
  width: 100%;
  height: 300px;
  background-color: rgba(255,255,255,0.95);
  transition: bottom 0.3s ease;
  z-index: 9999;
  padding: 20px;
  overflow-y: auto;
  border-top-left-radius: 20px;
  border-top-right-radius: 20px;
}

body.log-open #log-drawer {
  bottom: 120px; /* é¡¯ç¤ºåœ¨ç•«é¢åº•éƒ¨ä¸Šæ–¹ï¼Œé¿å…é®ä½æŒ‰éˆ• */
}

body.log-open .bg-white.rounded-xl {
  margin-bottom: 320px; /* æ¨é–‹ä¸»å…§å®¹ */
}

/* ======================================
ğŸ’¬ èŠå¤©å®¤æŠ½å±œæ¨£å¼
====================================== */
/* ğŸ’¬ èŠå¤©å®¤æŠ½å±œï¼ˆé è¨­éš±è—ï¼‰ */
#chat-panel {
  position: fixed;
  bottom: 0;
  right: 0;
  width: 100%;
  height:500px;
  background-color: rgb(255, 255, 255);
  transform: translateY(100%);
  transition: transform 0.1s ease-in-out;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  padding: 0; /* æ”¹æˆ 0 æ¯”è¼ƒæ–¹ä¾¿å½ˆæ€§æ§åˆ¶ */
  border-top-left-radius: 20px;
  border-top-right-radius: 20px;
}
#close-chat-btn {
  position: absolute;
  top: 5px;
  right: 20px;
  background: none;
  border: none;
  font-size: 60px;
  cursor: pointer;
  z-index: 1001;
}
body.chat-open #chat-panel {
  transform: translateY(0px); /* é¿é–‹åº•éƒ¨çš„å…©å€‹å¤§æŒ‰éˆ• */
}

/* èŠå¤©è¨Šæ¯å®¹å™¨ï¼ˆå¯æ²å‹•ï¼‰ */
#chat-messages {
  flex: 1;
  padding: 20px;
  font-size: 36px;
  overflow-y: auto;
}

/* èŠå¤©è¼¸å…¥å€å¡Šï¼ˆå›ºå®šåœ¨ä¸‹æ–¹ï¼‰ */
#chat-input-area {
  display: flex;
  gap: 10px;
  padding: 12px 20px;
  border-top: 1px solid #ccc;
  background: white;
}

#chat-input {
  flex: 1;
  font-size: 42px;
  padding: 12px;
}

#send-btn {
  font-size: 42px;
  padding: 24px 24px;
}


/* ğŸ”´ æ—¥èªŒè¦–çª—å…§çš„é‡ç½®æŒ‰éˆ• */
#reset-btn.reset-button {
  position: absolute;
  top: 12px;
  right: 20px;
  z-index: 10001;
  background-color: #ef4444;
  color: white;
  border: none;
  font-size: 40px;
  width: 100px;
  height: 100px;
  border-radius: 50%;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  cursor: pointer;
  transition: background-color 0.2s;
}
#reset-btn.reset-button:hover {
  background-color: #dc2626;
}


/* âœ… æ¢éšªæ¨¡å¼å•Ÿå‹•æ™‚ï¼Œè¦éš±è—çš„å€å¡Šï¼ˆé¿å…å¹²æ“¾ç•«é¢ï¼‰ */
body.exploring .status-panel,
body.exploring .info-panel,
body.exploring .button-wrapper,
body.exploring .control-panel,
body.exploring .lightning-flash,
body.exploring #weather-toggle,
body.exploring #moon,
body.exploring #starsContainer,
body.exploring #control-buttons,
body.exploring #rainContainer {
  display: none !important;
}

/* âœ… æ¢éšªæ™‚ç•«é¢ä¸Šé¡¯ç¤ºã€Œå†’éšªä¸­ã€çš„æ–‡å­— */
#explore-label {
  position: absolute;
  top: 40px;                       /* é›¢ä¸Šæ–¹è·é›¢ */
  left: 50%;
  transform: translateX(-50%);     /* æ°´å¹³ç½®ä¸­ */
  font-size: 60px;                 /* å­—é«”å¤ å¤§ï¼Œè®“ç©å®¶çœ‹æ¸…æ¥š */
  font-weight: bold;
  color: white;
  text-shadow: 2px 2px 4px black;  /* åŠ é»‘è‰²é™°å½±ï¼Œé¿å…ç™½å­—é›£çœ‹æ¸… */
  z-index: 50;
  display: none;                   /* åˆå§‹éš±è—ï¼Œé€²å…¥æ¢éšªæ™‚æ‰é¡¯ç¤º */
}

/* âœ… ç•¶ body åŠ ä¸Š exploring æ™‚ï¼Œé¡¯ç¤º explore-label */
body.exploring #explore-label {
  display: block;
}

/* âœ… æ¢éšªä¸­æ™‚éš±è—æ—¥èªŒæŒ‰éˆ•ç¾¤ï¼ˆé¿å…å¹²æ“¾ï¼‰ */
body.exploring #log-controls #chat-button-container {
  display: none !important;
}

/* âœ… æ¢éšªæ¨¡å¼ä¸­çš„ã€ŒçµæŸæ¢éšªã€æŒ‰éˆ•æ¨£å¼ï¼ˆç•«é¢åº•éƒ¨ç½®ä¸­ï¼‰ */
#end-explore-btn {
  display: none;                   /* é è¨­éš±è— */
  position: fixed;
  bottom: 80px;                    /* è·é›¢ç•«é¢åº•éƒ¨ 80px */
  left: 50%;
  transform: translateX(-50%);     /* æ°´å¹³ç½®ä¸­ */
  font-size: 60px;                 /* æŒ‰éˆ•æ–‡å­—å¤ å¤§ */
  padding: 24px 40px;              /* æŒ‰éˆ•å¤§å°é©ä¸­ */
  background-color: #ef4444;        /* ç´…è‰²èƒŒæ™¯ */
  color: white;
  border: none;
  border-radius: 16px;
  z-index: 10000;                  /* æ¥µé«˜å±¤ç´šï¼Œæ°¸é åœ¨æœ€ä¸Šæ–¹ */
}

/* âœ… æ¢éšªä¸­æ™‚é¡¯ç¤ºçµæŸæŒ‰éˆ• */
body.exploring #end-explore-btn {
  display: block;
}

</style>
<!-- ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ CSS æ¨£å¼å€å¡Š END ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ğŸ¨ -->

</head>



<body class="h-screen w-screen overflow-hidden m-0 p-0">


  <div id="login-modal" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50">
  <div class="bg-white p-6 rounded-lg shadow-md w-96">
    <h2 class="text-xl font-bold mb-4">ç™»å…¥éŠæˆ²</h2>
    <input type="text" id="player-id-input" class="w-full p-2 border border-gray-300 rounded mb-4" placeholder="è«‹è¼¸å…¥ä½ çš„ç©å®¶å¸³è™Ÿ">
    <button id="login-btn" class="w-full bg-blue-500 text-white py-2 rounded">ç™»å…¥</button>
  </div>
</div>

<!-- ğŸ£ é¸æ“‡å¯µç‰©æ¨¡æ…‹æ¡† -->
<div id="choose-pet-modal" class="modal">
  <div class="modal-content">
    <h2 class="text-xl font-bold mb-6">é¸æ“‡ä½ çš„åˆå§‹å¯µç‰©</h2>
    <div id="starter-pet-list" style="display: flex; flex-wrap: wrap; gap: 20px; justify-content: center;"></div>
  </div>
</div>

<!-- ğŸ’ èƒŒåŒ…æ¨¡æ…‹æ¡† START -->
<div id="backpack-modal" class="modal">
  <div class="modal-content">
    <h2 class="text-xl font-bold mb-4">èƒŒåŒ…å…§å®¹</h2>
    <div id="backpack-items" class="grid grid-cols-6 gap-4">
  <!-- æ¯è¡Œ6æ ¼ï¼Œå…±5è¡Œï¼ˆå…±30æ ¼ï¼‰ -->
</div>
    <button onclick="closeBackpack()" class="close-button">
      <i class="fas fa-times"></i>
    </button>
  </div>
</div>
<!-- ğŸ’ èƒŒåŒ…æ¨¡æ…‹æ¡† END -->


<!-- ğŸ§©ğŸ§©ğŸ§©ğŸ§©ğŸ§©ğŸ§©ğŸ§©ğŸ§©ğŸ§©ğŸ§© å‘½åæ¨¡æ…‹æ¡†å€å¡Š START ğŸ§©ğŸ§©ğŸ§©ğŸ§©ğŸ§©ğŸ§©ğŸ§©ğŸ§©ğŸ§©ğŸ§© -->
    <div id="name-modal" class="modal">
        <div class="modal-content">
            <h2 class="text-xl font-bold mb-4">ç‚ºä½ çš„å¯µç‰©å–å€‹åå­—</h2>
            <input type="text" id="pet-name-input" class="w-full border border-gray-300 rounded p-2 mb-4" placeholder="è¼¸å…¥åå­—">
            <button id="confirm-name-btn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded w-full">ç¢ºå®š</button>
        </div>
    </div>
    
<!-- æ”¹åæ¨¡æ…‹æ¡† -->
    <div id="rename-modal" class="modal">
        <div class="modal-content">
            <h2 class="text-xl font-bold mb-4">ç‚ºä½ çš„å¯µç‰©æ”¹å</h2>
            <input type="text" id="rename-input" class="w-full border border-gray-300 rounded p-2 mb-4" placeholder="è¼¸å…¥æ–°åå­—">
            <button id="confirm-rename-btn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded w-full">ç¢ºå®š</button>
        </div>
    </div>
    


<!-- ğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒ æ¢éšªé¸å–®æ¨¡æ…‹æ¡† START ğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒ -->
<div id="explore-modal" class="modal">
  <div class="modal-content">
    <!-- âŒ å‰å‰é—œé–‰æŒ‰éˆ• -->
   <button onclick="closeExploreModal()" class="close-button">
  <i class="fas fa-times"></i>
</button>

    <h2 class="text-xl font-bold mb-6">é¸æ“‡æ¢éšªåœ°é»</h2>
    <button class="bg-orange-400 hover:bg-orange-500 text-white px-6 py-3 rounded mb-4 w-full" onclick="startExploration('å’•å’•æ´ç©´')">å’•å’•æ´ç©´</button>
    <button class="bg-purple-400 hover:bg-purple-500 text-white px-6 py-3 rounded mb-4 w-full" onclick="startExploration('ç¥ç§˜æ´ç©´')">ç¥ç§˜æ´ç©´</button>
    <button class="bg-gray-600 hover:bg-gray-700 text-white px-6 py-3 rounded w-full" onclick="startExploration('é»‘æš—æ£®æ—')">é»‘æš—æ£®æ—</button>
  </div>
</div>
<!-- ğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒ æ¢éšªé¸å–®æ¨¡æ…‹æ¡† END ğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒ -->

<!-- ğŸğŸğŸğŸğŸğŸğŸğŸğŸğŸğŸğŸğŸğŸğŸğŸğŸğŸğŸ æ¢éšªçå‹µæ¨¡æ…‹æ¡†ğŸğŸğŸğŸğŸğŸğŸğŸğŸğŸğŸğŸğŸ -->
<div id="explore-reward-modal" class="modal">
  <div class="modal-content">
    <h2 class="text-xl font-bold mb-4">ç²å¾—ç‰©å“</h2>
    <div id="reward-items" class="mb-4 text-4xl">...</div>
    <button onclick="confirmReward()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded w-full text-3xl">ç¢ºå®š</button>
  </div>
</div>

<!-- âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ… æ—¥èªŒæ»‘å‡ºå®¹å™¨ STARTâœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ… -->
<div id="log-drawer">
  <button id="reset-btn" class="reset-button"><i class="fas fa-sync-alt"></i></button>
  <div id="log" style="font-size: 32px; line-height: 1.5;">
    <p>æ„›ä½ çš„å¯µç‰©ï¼</p>
  </div>
</div>
<!-- ğŸ’¬ èŠå¤©å®¤æŠ½å±œ -->
<div id="chat-panel">
  <!-- âŒ é—œé–‰æŒ‰éˆ• -->
  <button id="close-chat-btn">Ã—</button>
  <div id="chat-messages" style="flex: 1; overflow-y: auto;">
    <!-- è¨Šæ¯å…§å®¹ -->
    <p>ç³»çµ±ï¼šä¸€èµ·ä¾†å°¬èŠï¼</p>
  </div>

  <div id="chat-input-area">
    <input type="text" id="chat-input" placeholder="è¼¸å…¥è¨Šæ¯..." />
    <button id="send-btn">é€å‡º</button>
  </div>
</div>




<!-- âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ… æ—¥èªŒæ»‘å‡ºå®¹å™¨ ENDâœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ… -->

    <div class="bg-white rounded-xl shadow-lg p-4 w-full h-full relative">


<!-- ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ å¤©æ°£åˆ‡æ›æŒ‰éˆ• START ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ -->
          <div class="name-container mb-4">
           
            
        </div>
 <!-- ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ å¤©æ°£åˆ‡æ›æŒ‰éˆ• END ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ -->       
        
<div class="pet-area absolute top-0 left-0 w-full h-full z-0" id="pet-area">

  
  <!-- ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ å¯µç‰©é¡¯ç¤ºå€å¡Š START ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ -->
  <div id="chicken-container" class="chicken-container">
    <div id="speech-bubble" class="speech-bubble"></div>
    <div id="chicken" class="sprite"></div>
    <div id="zzz-container" class="absolute -top-6 left-1/2 transform -translate-x-1/2 hidden"></div>
  </div>
 <!-- ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ å¯µç‰©é¡¯ç¤ºå€å¡Š END ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ğŸ¤ -->

  <!-- ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ æ¢éšªæ–‡å­—èˆ‡æŒ‰éˆ• ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ-->
  <div id="explore-label">å†’éšªä¸­...</div>
  <button id="end-explore-btn">çµæŸæ¢éšª</button>

  <!-- ğŸŒ™ / â­ / ğŸŒ§ï¸ / ğŸ’© -->
  <div id="moon"></div>
  <div id="starsContainer"></div>
  <div id="rainContainer"></div>
  <div id="poop-container"></div>

</div>

  <!-- ğŸŸ¢ğŸŸ¢ğŸŸ¢ğŸŸ¢ğŸŸ¢ğŸŸ¢ğŸŸ¢ğŸŸ¢ğŸŸ¢ğŸŸ¢ğŸŸ¢ å·¦ä¸Šè§’è‰²è³‡è¨ŠğŸŸ¢ğŸŸ¢ğŸŸ¢ğŸŸ¢ğŸŸ¢ğŸŸ¢ğŸŸ¢ğŸŸ¢ğŸŸ¢ğŸŸ¢ -->
  <!-- å·¦ä¸Šè§’æ©¢åœ“è³‡è¨Šæ¬„ -->
<div class="info-panel">

  <!-- å·¦ï¼šç­‰ç´šåœ“ç’° -->
  <div class="level-circle">
    <svg viewBox="0 0 36 36" class="level-circle-svg">
      <path class="bg" d="M18 2.0845a15.9155 15.9155 0 1 1 0 31.831a15.9155 15.9155 0 1 1 0 -31.831"/>
      <path id="exp-ring" class="progress" d="M18 2.0845a15.9155 15.9155 0 1 1 0 31.831a15.9155 15.9155 0 1 1 0 -31.831"/>
      <g class="level-label">
        <text class="level-text" x="18" y="13" text-anchor="middle">Lv</text>
        <text class="level-number" x="18" y="24" text-anchor="middle" id="level">1</text>
      </g>
    </svg>
  </div>

  <!-- ä¸­ï¼šåå­—ã€ç‹€æ…‹ã€é‡‘å¹£ -->
  <div class="center-info">
    <div class="name-row">
      <h2 id="pet-name-display">æœªå‘½å</h2>
      <button id="rename-btn"><i class="fas fa-pen"></i></button>
    </div>
    <div class="status-row"><span id="status">ğŸ˜Š ç‹€æ…‹è‰¯å¥½</span>
    </div>
  </div>

  <!-- å³ï¼šé‡‘å¹£ -->
  <div class="coin-box">
    <span id="coins">0</span>
    <i class="fas fa-coins"></i>
  </div>

  <!-- ç‹€æ…‹åœ“åœˆ -->
<div class="status-circles flex items-center justify-end"> <!-- åŠ ä¸Š justify-end è®“æ•´é«”é å³ -->

  <!-- é£¢é¤“ -->
  <div class="circle-wrapper hunger">
    <svg class="circle-svg" viewBox="0 0 100 100">
      <circle class="circle-bg" cx="50" cy="50" r="45" />
      <circle id="hunger-bar" class="circle-bar" cx="50" cy="50" r="45" />
      <text x="50" y="55" text-anchor="middle" class="circle-title">é£¢é¤“</text>
    </svg>
    <div id="hunger-value" class="status-value">100%</div>
  </div>

  <!-- å¿«æ¨‚ -->
  <div class="circle-wrapper happiness">
    <svg class="circle-svg" viewBox="0 0 100 100">
      <circle class="circle-bg" cx="50" cy="50" r="45" />
      <circle id="happiness-bar" class="circle-bar" cx="50" cy="50" r="45" />
      <text x="50" y="55" text-anchor="middle" class="circle-title">å¿«æ¨‚</text>
    </svg>
    <div id="happiness-value" class="status-value">100%</div>
  </div>

  <!-- ç²¾åŠ› -->
  <div class="circle-wrapper energy">
    <svg class="circle-svg" viewBox="0 0 100 100">
      <circle class="circle-bg" cx="50" cy="50" r="45" />
      <circle id="energy-bar" class="circle-bar" cx="50" cy="50" r="45" />
      <text x="50" y="55" text-anchor="middle" class="circle-title">ç²¾åŠ›</text>
    </svg>
    <div id="energy-value" class="status-value">100%</div>
  </div>

  <!-- æ¸…æ½” -->
  <div class="circle-wrapper cleanliness">
    <svg class="circle-svg" viewBox="0 0 100 100">
      <circle class="circle-bg" cx="50" cy="50" r="45" />
      <circle id="cleanliness-bar" class="circle-bar" cx="50" cy="50" r="45" />
      <text x="50" y="55" text-anchor="middle" class="circle-title">æ¸…æ½”</text>
    </svg>
    <div id="cleanliness-value" class="status-value">100%</div>
  </div>
</div>
</div>

  <!-- ä¸‹æ–¹å¤©æ°£æŒ‰éˆ• -->
  <div id="weather-toggle">
    <i id="weather-icon" class="fas fa-sun"></i>
  </div>

<!-- ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ  æŒ‰éˆ•åŠŸèƒ½å€å¡Š START ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ  -->        
   <div class="button-wrapper">
  <div class="button-row">
    <button id="feed-btn" class="btn-circle bg-yellow-400 hover:bg-yellow-500">
  <i class="fas fa-utensils"></i>
  <span>é¤µé£Ÿ</span>
</button>

<button id="play-btn" class="btn-circle bg-blue-400 hover:bg-blue-500">
  <i class="fas fa-gamepad"></i>
  <span>ç©è€</span>
</button>

<button id="clean-btn" class="btn-circle bg-green-400 hover:bg-green-500">
  <i class="fas fa-bath"></i>
  <span>æ¸…æ½”</span>
</button>

<button id="sleep-btn" class="btn-circle bg-purple-400 hover:bg-purple-500">
  <i class="fas fa-moon"></i>
  <span>ç¡è¦º</span>
</button>

 <button id="bag-btn" class="btn-circle bg-gray-400 hover:bg-gray-500">
      <i class="fas fa-box-open"></i>
      <span>èƒŒåŒ…</span>
    </button>

    <button id="explore-btn" class="btn-circle bg-orange-400 hover:bg-orange-500">
      <i class="fas fa-map-marked-alt"></i>
      <span>æ¢éšª</span>
    </button>
<button id="evolve-btn" class="btn-circle bg-pink-400 hover:bg-pink-500">
  <i class="fas fa-dna"></i>
  <span>é€²åŒ–</span>
</button>
  </div>
</div>

<!-- ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ  æŒ‰éˆ•åŠŸèƒ½å€å¡Š END ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ ğŸŸ  -->

<!-- ğŸ“¦ åº•éƒ¨å…±åŒæ§åˆ¶å€å¡Š -->
<!-- âœ… åŒ…ä½æŒ‰éˆ•çš„å®¹å™¨ï¼Œé€™å€‹ id å¯ä»¥è®“æˆ‘å€‘æ§åˆ¶æ•´å¡Šä¸€èµ·éš±è— -->
<div id="control-buttons" class="fixed bottom-0 left-0 w-full flex z-50">
  <!-- ğŸ“‹ æŸ¥çœ‹æ—¥èªŒæŒ‰éˆ•ï¼ˆå·¦å´ 50%ï¼‰ -->
  <div class="w-1/2">
    <button id="toggle-log-btn" class="w-full bg-blue-500 btn-large">
      æŸ¥çœ‹æ—¥èªŒ
    </button>
  </div>

  <!-- ğŸ’¬ èŠå¤©å®¤æŒ‰éˆ•ï¼ˆå³å´ 50%ï¼‰ -->
  <div class="w-1/2">
    <button id="chat-toggle-btn" class="w-full bg-pink-500 btn-large">
      èŠå¤©å®¤
    </button>
  </div>
</div>


 <!-- ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§  JavaScript éŠæˆ²é‚è¼¯å€å¡Š START ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§  -->
   <script>


 const apiKey = 'AIzaSyBYbCZQNBg5SJ5_msWws9sDok7fE2hPd20'; // å·²æ’å…¥ä½ çš„ Gemini API é‡‘é‘°

async function sendMessage() {
  const input = document.getElementById('chat-input');
  const chatbox = document.getElementById('chat-messages');
  const userMsg = input.value.trim();
  if (!userMsg) return;

  chatbox.innerHTML += `<div class="msg user">ä½ ï¼š${userMsg}</div>`;
  input.value = '';
  chatbox.scrollTop = chatbox.scrollHeight;

}

function showStarterPetModal() {
  const list = document.getElementById('starter-pet-list');
  list.innerHTML = ''; // æ¸…ç©ºèˆŠè³‡æ–™

  const starters = evolutionData.filter(e => parseInt(e.stage) === 1);
  starters.forEach(petOption => {
    const div = document.createElement('div');
    div.style.cursor = 'pointer';
    div.style.textAlign = 'center';

    const img = document.createElement('img');
    img.src = petOption.image;
    img.style.width = '150px';
    img.style.height = '150px';
    img.style.objectFit = 'contain';
    img.style.borderRadius = '16px';

   const name = document.createElement('div');
name.textContent = petOption["åå­"] || petOption["è§’è‰²åç¨±"];

    div.appendChild(img);
    div.appendChild(name);

    div.addEventListener('click', () => {
      pet.spriteName = petOption.name;
      pet.stage = parseInt(petOption.stage);
      document.getElementById('choose-pet-modal').style.display = 'none';
      showNameModal(); // é¸å®Œå¾Œé¡¯ç¤ºå‘½åè¦–çª—
      updateChickenSprite(); // é¡¯ç¤ºé¸åˆ°çš„è§’è‰²
    });

    list.appendChild(div);
  });

  document.getElementById('choose-pet-modal').style.display = 'flex';
}



// ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ åˆå§‹åŒ–éŠæˆ²é‚è¼¯ä¸»æµç¨‹ START ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„
        function initPet() {
            // å˜—è©¦å¾localStorageåŠ è¼‰ä¿å­˜çš„éŠæˆ²
            loadGame();
            
            // å¦‚æœæ²’æœ‰åå­—ï¼Œé¡¯ç¤ºé¸æ“‡å¯µç‰©æ¨¡æ…‹æ¡† â†’ å†å‘½å
if (!pet.name) {
    showStarterPetModal();  // é€™æ˜¯é¸å¯µç‰©çš„è¦–çª—
} else {
    updateNameDisplay();
}

            updateChickenSprite(); // âœ… åˆå§‹åŒ–æ™‚è®€å–è§’è‰²åœ–ç‰‡
            updateStatusBars();
            updateSleepButton();

            autoSetWeatherByTime();  // âœ… æ’åœ¨é€™é‚Š
            
            // è¨­ç½®è¨ˆæ™‚å™¨
           setInterval(updatePetStatus, 1000); // æ¯ 1 ç§’æ›´æ–°ä¸€æ¬¡ç‹€æ…‹ï¼ˆé£¢é¤“ã€å¿«æ¨‚ã€ç²¾åŠ›ç­‰è®ŠåŒ–ï¼‰
           setInterval(autoMove, 1000);// æ¯ 1ç§’è‡ªå‹•èµ°å‹•ä¸€æ¬¡
           setInterval(autoAction, 3000); // æ¯ 3 ç§’æª¢æŸ¥æ˜¯å¦åŸ·è¡Œè¡Œç‚ºï¼ˆè‡ªå‹•åƒã€ç©ã€ç¡ï¼‰
           setInterval(checkNeeds, 3000); // æ¯ 3 ç§’æª¢æŸ¥æ˜¯å¦éœ€è¦æç¤ºéœ€æ±‚ï¼ˆé¤“ã€é«’ã€ç„¡èŠï¼‰
           setInterval(poop, 300000);    // æ¯ 60ç§’å¯èƒ½æœƒå¤§ä¾¿ä¸€æ¬¡
           setInterval(saveGame, 30000);  // æ¯ 30 ç§’è‡ªå‹•å­˜æª”
           setInterval(autoSetWeatherByTime, 3600000);   // æ¯ 1 å°æ™‚ä¾æ™‚é–“è®Šæ›å¤©æ°£
            
            // æ·»åŠ äº‹ä»¶ç›£è½å™¨
            feedBtn.addEventListener('click', feedPet);
            playBtn.addEventListener('click', playWithPet);
            cleanBtn.addEventListener('click', cleanPet);
            sleepBtn.addEventListener('click', toggleSleep);
            confirmNameBtn.addEventListener('click', confirmName);
            confirmRenameBtn.addEventListener('click', confirmRename);
            renameBtn.addEventListener('click', showRenameModal);
 
      
document.getElementById('evolve-btn').addEventListener('click', () => {
  if (!evolutionData || evolutionData.length === 0) {
    alert("é€²åŒ–è³‡æ–™å°šæœªè¼‰å…¥å®Œæˆï¼Œè«‹ç¨å¾Œå†è©¦ï¼");
    return;
  }

 checkEvolution();       // âœ… åªæœ‰æŒ‰æŒ‰éˆ•æ‰è§¸ç™¼é€²åŒ–
  updateChickenSprite();
});
    
            document.getElementById('weather-btn').addEventListener('click', () => {
    const weathers = ['sunny', 'rainy', 'hot', 'night'];
    pet.weather = weathers[Math.floor(Math.random() * weathers.length)];
    updateWeather();
});
            
            // åˆå§‹ä½ç½®
            const areaWidth = petArea.clientWidth;
            const areaHeight = petArea.clientHeight;
            pet.position.x = areaWidth / 2;
            pet.position.y = areaHeight / 2;
            updatePosition();
            
            if (pet.growthStage === 0) {
                addLog(`${pet.name}å·²ç¶“åœ¨ç·šä¸Šå•¦ï¼`);
            } else {
                addLog(`${pet.name}å›ä¾†äº†ï¼`);
            }
        }
// ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„ åˆå§‹åŒ–éŠæˆ²ä¸»æµç¨‹ END ğŸ”„ğŸ”„ğŸ”„ğŸ”„ğŸ”„

// ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ å¯µç‰©ç‹€æ…‹è³‡æ–™å€ START ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£
const pet = {
  name: "",                  // ğŸ¤ å¯µç‰©çš„åå­—ï¼ˆå‘½åèˆ‡é¡¯ç¤ºç”¨ï¼‰
  spriteName: "gugu_egg",
  level: 1,                  // ğŸ“ˆ ç­‰ç´šï¼ˆæ¯7å¤©å‡ç´šä¸€æ¬¡ï¼Œç”¨æ–¼é€²åŒ–èˆ‡é›£åº¦èª¿æ•´ï¼‰
  exp: 0,        // å¾ 0 é–‹å§‹
  maxExp: 100,   // æ¯ç´šæ‰€éœ€ç¶“é©—
  stage: 1,               
  hunger: 100,               // ğŸ½ï¸ é£¢é¤“åº¦ï¼ˆè‡ªå‹•åƒé£¯æˆ–éœ€é¤µé£Ÿï¼‰
  happiness: 100,           // ğŸ® å¿«æ¨‚åº¦ï¼ˆèˆ‡ç©å…·æˆ–äº’å‹•å½±éŸ¿ï¼‰
  energy: 100,              // ğŸ’¤ ç²¾åŠ›ï¼ˆå½±éŸ¿ç¡è¦ºé‚è¼¯ï¼‰
  cleanliness: 100,         // ğŸ§¼ æ¸…æ½”åº¦ï¼ˆæ‹‰å±å¾Œæœƒä¸‹é™ï¼‰
  isSleeping: false,        // ğŸ˜´ æ˜¯å¦æ­£åœ¨ç¡è¦º
  isEating: false,          // ğŸ½ï¸ æ˜¯å¦æ­£åœ¨åƒæ±è¥¿
  isPlaying: false,         // ğŸ² æ˜¯å¦æ­£åœ¨ç©è€
  position: { x: 0, y: 0 }, // ğŸ“ ç•¶å‰åº§æ¨™ä½ç½®ï¼ˆç§»å‹•å‹•ç•«èˆ‡ autoMove ç”¨ï¼‰
  direction: 1,             // â¡ï¸ ç§»å‹•æ–¹å‘ï¼ˆ1: å‘å³ï¼Œ-1: å‘å·¦ï¼‰
  mood: 'happy',            // ğŸ˜€ å¿ƒæƒ…ç‹€æ…‹ï¼ˆæœªä½¿ç”¨ï¼Œä½†å¯ç”¨æ–¼é¡å¤–è¡Œç‚ºé‚è¼¯ï¼‰
  lastActionTime: Date.now(),           // â±ï¸ ä¸Šæ¬¡è‡ªå‹•è¡Œç‚ºçš„æ™‚é–“ï¼ˆå¦‚ autoActionï¼‰
  lastHungerDecrease: Date.now(),       // â±ï¸ ä¸Šæ¬¡é£¢é¤“ä¸‹é™æ™‚é–“
  lastHappinessDecrease: Date.now(),    // â±ï¸ ä¸Šæ¬¡å¿«æ¨‚ä¸‹é™æ™‚é–“
  lastEnergyDecrease: Date.now(),       // â±ï¸ ä¸Šæ¬¡ç²¾åŠ›è®Šå‹•æ™‚é–“
  lastCleanlinessDecrease: Date.now(),  // â±ï¸ ä¸Šæ¬¡æ¸…æ½”åº¦ä¸‹é™æ™‚é–“
  lastAgeIncrease: Date.now(),          // â±ï¸ ä¸Šæ¬¡å¹´é½¡æˆé•·æ™‚é–“
  lastPoopTime: Date.now(),             // â±ï¸ ä¸Šæ¬¡å¤§ä¾¿æ™‚é–“
  lastSaveTime: Date.now(),             // ğŸ’¾ ä¸Šæ¬¡å­˜æª”æ™‚é–“ï¼ˆåˆ¤æ–·é›¢ç·šæ™‚é–“å·®ï¼‰
  weather: 'sunny'          // ğŸŒ¤ï¸ ç•¶å‰å¤©æ°£ç‹€æ…‹ï¼ˆsunny/rainy/hot/nightï¼‰
};
let lastTalkTime = 0;
const talkCooldown = 5000; // æ¯ 5 ç§’åªèƒ½èªªè©±ä¸€æ¬¡
     
// ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ å¯µç‰©ç‹€æ…‹è³‡æ–™å€ END ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£ğŸ£



// ğŸ“ŠğŸ“ŠğŸ“ŠğŸ“ŠğŸ“Š ç‹€æ…‹æ¢èˆ‡ UI é¡¯ç¤º START ğŸ“ŠğŸ“ŠğŸ“ŠğŸ“ŠğŸ“Š
// æ›´æ–°ç‹€æ…‹æ¢
        function updateStatusBars() {
  // ğŸ” æ°´å¹³é€²åº¦æ¢æ›´æ–°ï¼ˆä¿ç•™ï¼‰
  hungerBar.style.width = `${pet.hunger}%`;
  happinessBar.style.width = `${pet.happiness}%`;
  energyBar.style.width = `${pet.energy}%`;
  cleanlinessBar.style.width = `${pet.cleanliness}%`;

  // âœ… åŒæ­¥æ›´æ–°åœ“å½¢æ¢çš„ç™¾åˆ†æ¯”æ•¸å­—
  document.getElementById('hunger-value').textContent = `${pet.hunger}%`;
  document.getElementById('happiness-value').textContent = `${pet.happiness}%`;
  document.getElementById('energy-value').textContent = `${pet.energy}%`;
  document.getElementById('cleanliness-value').textContent = `${pet.cleanliness}%`;

  // âœ… åŒæ­¥æ›´æ–°åœ“å½¢æ¢çš„ SVG è¦–è¦ºé€²åº¦
  setCircleProgress('hunger-bar', pet.hunger);
  setCircleProgress('happiness-bar', pet.happiness);
  setCircleProgress('energy-bar', pet.energy);
  setCircleProgress('cleanliness-bar', pet.cleanliness);

  // ç­‰ç´šé¡¯ç¤º
  levelDisplay.textContent = pet.level;

  // ğŸ§  ç‹€æ…‹æ–‡å­—é‚è¼¯
  if (document.body.classList.contains('exploring')) {
    statusDisplay.textContent = "ğŸŒ² æ¢éšªä¸­...";
    statusDisplay.className = "text-white font-bold";
    return;
  }

  if (pet.isSleeping) {
    statusDisplay.textContent = "ğŸ˜´ ç¡è¦ºä¸­";
    statusDisplay.className = "text-purple-600";
    randomTalk('sleeping');
  } else if (pet.isEating) {
    statusDisplay.textContent = "ğŸ½ï¸ é€²é£Ÿä¸­";
    statusDisplay.className = "text-yellow-600";
    randomTalk('eating');
  } else if (pet.isPlaying) {
    statusDisplay.textContent = "ğŸ® ç©è€ä¸­";
    statusDisplay.className = "text-blue-600";
    randomTalk('playing');
  } else if (pet.hunger < 30) {
    statusDisplay.textContent = "ğŸ— è‚šå­å¥½é¤“";
    statusDisplay.className = "text-red-500 font-bold";
    randomTalk('hungry');
  } else if (pet.energy < 30) {
    statusDisplay.textContent = "ğŸ¥± æœ‰é»ç´¯";
    statusDisplay.className = "text-indigo-500 font-bold";
    randomTalk('tired');
  } else if (pet.happiness < 30) {
    statusDisplay.textContent = "ğŸ˜¢ å¿ƒæƒ…ä¸å¥½";
    statusDisplay.className = "text-gray-600 font-bold";
    randomTalk('bored');
  } else if (pet.cleanliness < 30) {
    statusDisplay.textContent = "ğŸ§¼ é«’å…®å…®";
    statusDisplay.className = "text-brown-500 font-bold";
    randomTalk('dirty');
  } else {
    statusDisplay.textContent = "ğŸ˜Š ç‹€æ…‹è‰¯å¥½";
    statusDisplay.className = "text-green-600";
    randomTalk('normal');
  }
  
}
function setCircleProgress(circleId, percent) {
  const circle = document.getElementById(circleId);
  const radius = 45;
  const circumference = 2 * Math.PI * radius;
  const offset = circumference * (1 - percent / 100);
  circle.style.strokeDasharray = `${circumference - offset} ${circumference}`;
}

        // æ›´æ–°ä½ç½®
        function updatePosition() {
  chickenContainer.style.left = `${pet.position.x}px`;
  chickenContainer.style.top = `${pet.position.y}px`;

   // æ ¹æ“šæ–¹å‘ç¿»è½‰åœ–åƒ
  if (pet.direction === -1) {
    chicken.style.transform = 'scaleX(-1)';
  } else {
    chicken.style.transform = 'scaleX(1)';
  }
}
// ğŸ“ŠğŸ“ŠğŸ“ŠğŸ“ŠğŸ“Š ç‹€æ…‹æ¢èˆ‡ UI é¡¯ç¤º END ğŸ“ŠğŸ“ŠğŸ“ŠğŸ“ŠğŸ“Š


// âœï¸âœï¸âœï¸âœï¸ å‘½åèˆ‡æ”¹ååŠŸèƒ½ START âœï¸âœï¸âœï¸âœï¸
        function updateNameDisplay() {
            if (pet.name) {
                petNameDisplay.textContent = pet.name;
            } else {
                petNameDisplay.textContent = "æœªå‘½å";
            }
        }

        // é¡¯ç¤ºå‘½åæ¨¡æ…‹æ¡†
        function showNameModal() {
            nameModal.style.display = 'flex';
            petNameInput.focus();
        }

        // é¡¯ç¤ºæ”¹åæ¨¡æ…‹æ¡†
        function showRenameModal() {
            if (pet.isDead) return;
            
            renameInput.value = pet.name;
            renameModal.style.display = 'flex';
            renameInput.focus();
        }

        // ç¢ºèªåå­—
        function confirmName() {
  const name = petNameInput.value.trim();
  if (name) {
    pet.name = name;
    nameModal.style.display = 'none';
    updateNameDisplay();
    updateNameTag();
    addLog(`ä½ å°‡å¯µç‰©å‘½åç‚ºã€Œ${pet.name}ã€`);
    saveGame(); // âœ… å‘½åå¾Œé¦¬ä¸Šå­˜æª”
  } else {
    alert("è«‹è¼¸å…¥ä¸€å€‹æœ‰æ•ˆçš„åå­—ï¼");
  }
}
        // ç¢ºèªæ”¹å
        function confirmRename() {
            const newName = renameInput.value.trim();
            if (newName) {
                const oldName = pet.name;
                pet.name = newName;
                renameModal.style.display = 'none';
                updateNameDisplay();
                updateNameTag();
                addLog(`ä½ å°‡å¯µç‰©ã€Œ${oldName}ã€æ”¹åç‚ºã€Œ${newName}ã€`);
                saveGame();
            } else {
                alert("è«‹è¼¸å…¥ä¸€å€‹æœ‰æ•ˆçš„åå­—ï¼");
            }
        }

      
// âœï¸âœï¸âœï¸âœï¸ å‘½åèˆ‡æ”¹ååŠŸèƒ½ END âœï¸âœï¸âœï¸âœï¸

// ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ è‡ªå‹•è¨­å®šå¤©æ°£ï¼ˆæ ¹æ“šæ™‚é–“ï¼‰ START
function autoSetWeatherByTime() {
    const hour = new Date().getHours();

    if (hour >= 6 && hour < 18) {
        // ç™½å¤© â†’ éš¨æ©Ÿé¸æ“‡ sunny / rainy / hot
        const dayWeathers = ['sunny', 'rainy', 'hot', 'storm'];
        pet.weather = dayWeathers[Math.floor(Math.random() * dayWeathers.length)];
    } else {
        // æ™šä¸Š â†’ å›ºå®š night
        pet.weather = 'night';
    }

    updateWeather();
}

// ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸è‡ªå‹•è¨­å®šå¤©æ°£ ENDğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸


// ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ å¤©æ°£æ§åˆ¶é‚è¼¯ START ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸
        function toggleWeather() {
    const weatherList = ['sunny', 'rainy', 'hot', 'storm', 'night'];
    const currentIndex = weatherList.indexOf(pet.weather);
    pet.weather = weatherList[(currentIndex + 1) % weatherList.length];

    

    updateWeather();
    addLog(`å¤©æ°£è®Šæˆäº†ï¼š${pet.weather}`);
    saveGame();
     // âœ… æ ¹æ“šæ–°å¤©æ°£å‘¼å«ä¸åŒçš„è©±èª
  switch (pet.weather) {
    case 'sunny':
      randomTalk('weather_sunny');
      break;
    case 'rainy':
      randomTalk('weather_rainy');
      break;
    case 'hot':
      randomTalk('weather_hot');
      break;
      case 'storm':
    randomTalk('weather_storm');
    break;
    case 'night':
      randomTalk('weather_night');
      break;
  }
}
let lightningLoopInterval;


  function updateWeather() {
  petArea.style.backgroundImage = '';
  petArea.classList.remove('daytime', 'nighttime');

  document.getElementById('rainContainer').innerHTML = '';
  document.getElementById('starsContainer').innerHTML = '';
  document.querySelectorAll('.lightning-flash').forEach(flash => flash.remove());
  clearInterval(lightningLoopInterval);

  switch (pet.weather) {
    case 'sunny':
      petArea.style.backgroundImage = "url('https://i.imgur.com/qB5GmEI.png')";
      document.getElementById('weather-icon').className = "fas fa-cloud-sun text-yellow-500";
      break;
    case 'rainy':
      petArea.style.backgroundImage = "url('https://i.imgur.com/EKyxQMx.png')";
      document.getElementById('weather-icon').className = "fas fa-cloud-showers-heavy text-blue-500";
      createRainEffect();
      break;
    case 'hot':
      petArea.style.backgroundImage = "url('https://i.imgur.com/YrLNhPO.png')";
      document.getElementById('weather-icon').className = "fas fa-sun text-orange-500";
      break;
    case 'storm':
      petArea.style.backgroundImage = "url('https://i.imgur.com/uU3ed04.png')";
      document.getElementById('weather-icon').className = "fas fa-bolt text-purple-500";
      createRainEffect();
      createLightningEffect(2);
      lightningLoopInterval = setInterval(() => {
        const repeat = 2 + Math.floor(Math.random() * 2);
        createLightningEffect(repeat);
      }, 10000 + Math.random() * 5000);
      break;
    case 'night':
      petArea.style.backgroundImage = "url('https://i.imgur.com/UQS4dtr.png')";
      document.getElementById('weather-icon').className = "fas fa-moon text-yellow-500";
      createStars();
      break;
  }

  const moon = document.getElementById('moon');
  moon.style.display = pet.weather === 'night' ? 'block' : 'none';

  petArea.style.backgroundSize = 'cover';
  petArea.style.backgroundPosition = 'center';
}


function createLightningEffect(repeat = 3, delay = 300) {
  if (document.body.classList.contains('exploring')) return;

  let count = 0;
  const flashOnce = () => {
    const flash = document.createElement('div');
    flash.className = 'lightning-flash';
    document.body.appendChild(flash);

    setTimeout(() => {
      flash.style.opacity = '0';
      setTimeout(() => flash.remove(), 200);
    }, 100);

    count++;
    if (count < repeat) {
      setTimeout(flashOnce, delay + Math.random() * 200);
    }
  };

  flashOnce();
}




function createRainEffect() {
  const rainContainer = document.getElementById('rainContainer');
  rainContainer.innerHTML = ''; // â— æ¸…æ‰ä¹‹å‰çš„é›¨æ»´

  for (let i = 0; i < 50; i++) {
    const drop = document.createElement('div');
    drop.className = 'raindrop';
    drop.style.left = `${Math.random() * 100}%`;
    drop.style.animationDelay = `${Math.random() * 2}s`;
    rainContainer.appendChild(drop); // âœ… åŠ å…¥æ­£ç¢ºå®¹å™¨
  }
}

function createStars() {
  const starsContainer = document.getElementById('starsContainer');
  starsContainer.innerHTML = ''; // æ¸…é™¤èˆŠæ˜Ÿæ˜Ÿ âœ…

  for (let i = 0; i < 80; i++) {
    const star = document.createElement('div');
    star.className = 'star';
    star.style.top = `${Math.random() * 100}%`;
    star.style.left = `${Math.random() * 100}%`;
    star.style.animationDelay = `${Math.random() * 2}s`;
    starsContainer.appendChild(star);
  }
}
// ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ å¤©æ°£æ§åˆ¶é‚è¼¯ END ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸ğŸŒ¤ï¸

// âœ¨âœ¨âœ¨âœ¨âœ¨ è‡ªå‹•è¡Œç‚ºæ§åˆ¶ START âœ¨âœ¨âœ¨âœ¨âœ¨
      function autoMove() {
  if (pet.isSleeping || pet.isEating || pet.isPlaying || pet.isDead) return;

  const areaRect = petArea.getBoundingClientRect(); // ğŸŸ¦ å–å¾—çœŸæ­£çš„å¯æ´»å‹•å€åŸŸ

  const marginX = 200;  // å·¦å³å®‰å…¨é‚Šè·
  const leftLimit = areaRect.left + marginX;
  const rightLimit = areaRect.right - marginX;

  const topLimit = areaRect.top + 600; // é ‚ç«¯ + 200 é«˜åº¦

  const buttonWrapper = document.querySelector('.button-wrapper');
  const buttonTop = buttonWrapper.getBoundingClientRect().top;
  const bottomLimit = buttonTop - 80;

  // éš¨æ©Ÿæ˜¯å¦è¦ç§»å‹•
  if (Math.random() > 0.3) {
    pet.direction = Math.random() > 0.5 ? 1 : -1;

    let newX = pet.position.x + (pet.direction * (20 + Math.random() * 30));
    let newY = pet.position.y + (Math.random() > 0.5 ? -10 : 10);

    // é™åˆ¶ X, Y ä¸è¶…å‡ºé‚Šç•Œ
    newX = Math.max(leftLimit, Math.min(rightLimit, newX));
    newY = Math.max(topLimit, Math.min(bottomLimit, newY));

    pet.position.x = newX;
    pet.position.y = newY;

    // å‹•ç•«
    chicken.classList.add('walking');
    setTimeout(() => {
      chicken.classList.remove('walking');
    }, 500);

    updatePosition();

    if (Math.random() > 0.5) {
      randomTalk('walk');
    }
  }

  // âœ… é¡¯ç¤ºæ¡†ç·š debug
  const moveRange = document.getElementById('move-range');
  if (moveRange) {
    moveRange.style.left = `${leftLimit}px`;
    moveRange.style.top = `${topLimit}px`;
    moveRange.style.width = `${rightLimit - leftLimit}px`;
    moveRange.style.height = `${bottomLimit - topLimit}px`;
  }
}

        function autoAction() {
    if (pet.isDead || pet.isEating || pet.isPlaying) return;

    const now = Date.now();

    // âœ… è‹¥å ´ä¸Šæœ‰é£Ÿç‰©ä¸”é£¢é¤“åº¦ä¸æ»¿ï¼Œå„ªå…ˆèµ°å»åƒ
    const foodItems = document.querySelectorAll('.food-item');
    if (foodItems.length > 0 && pet.hunger < 90) {
        const food = foodItems[0];
        const foodName = food.title;

        pet.isEating = true;
        chicken.classList.add('eating');
        randomTalk('eating');

        // æ¨¡æ“¬ç§»å‹•åˆ°é£Ÿç‰©ä½ç½®
        const foodRect = food.getBoundingClientRect();
        const areaRect = petArea.getBoundingClientRect();
        pet.position.x = foodRect.left - areaRect.left + foodRect.width / 2;
        pet.position.y = foodRect.top - areaRect.top + foodRect.height / 2;
        updatePosition();

        setTimeout(() => {
            pet.hunger = Math.min(100, pet.hunger + 30);
            pet.isEating = false;
            chicken.classList.remove('eating');
            food.remove();
            addLog(`${pet.name}è‚šå­é¤“ï¼Œåƒæ‰äº†${foodName}ï¼ˆ+30ï¼‰`);
            updateStatusBars();
            saveGame();
        }, 2000);
        return;
    }

    // âœ… è‹¥å ´ä¸Šæœ‰ç©å…·ä¸”å¿«æ¨‚åº¦ä¸æ»¿ï¼Œå„ªå…ˆå»ç©
    const toyItems = document.querySelectorAll('.toy-item');
    if (toyItems.length > 0 && pet.happiness < 90) {
        const toy = toyItems[0];
        const toyName = toy.title;

        pet.isPlaying = true;
        chicken.classList.add('playing');
        randomTalk('playing');

        const toyRect = toy.getBoundingClientRect();
        const areaRect = petArea.getBoundingClientRect();
        pet.position.x = toyRect.left - areaRect.left + toyRect.width / 2;
        pet.position.y = toyRect.top - areaRect.top + toyRect.height / 2;
        updatePosition();

        setTimeout(() => {
            pet.happiness = Math.min(100, pet.happiness + 30);
            pet.energy = Math.max(0, pet.energy - 10);
            pet.cleanliness = Math.max(0, pet.cleanliness - 10);
            pet.hunger = Math.max(0, pet.hunger - 10);
            pet.isPlaying = false;
            chicken.classList.remove('playing');
            toy.remove();
            addLog(`${pet.name}è‡ªå·±ç©äº†${toyName}ï¼ˆå¿«æ¨‚+30ã€ç²¾åŠ›-10ã€æ¸…æ½”-10ã€é£¢é¤“-10ï¼‰`);
            updateStatusBars();
            saveGame();
        }, 3000);
        return;
    }

    // é£¢é¤“åº¦ä½æ–¼ 50 è‡ªå‹•åƒé£¯
    if (pet.hunger < 50 && !pet.isEating) {
        pet.isEating = true;
        chicken.classList.add('eating');
        randomTalk('eating');
        setTimeout(() => {
            pet.hunger = Math.min(100, pet.hunger + 30);
            pet.isEating = false;
            chicken.classList.remove('eating');
            addLog(`${pet.name}è‚šå­é¤“ï¼Œè‡ªå‹•åƒäº†é£¯ï¼ˆ+30ï¼‰`);
            updateStatusBars();
            saveGame();
        }, 2000);
        return;
    }

    // å¿«æ¨‚åº¦ä½æ–¼ 50 è‡ªå‹•ç©
    if (pet.happiness < 50 && !pet.isPlaying) {
        pet.isPlaying = true;
        chicken.classList.add('playing');
        randomTalk('playing');
        setTimeout(() => {
            pet.happiness = Math.min(100, pet.happiness + 30);
            pet.energy = Math.max(0, pet.energy - 10);
            pet.cleanliness = Math.max(0, pet.cleanliness - 10);
            pet.hunger = Math.max(0, pet.hunger - 10);
            pet.isPlaying = false;
            chicken.classList.remove('playing');
            addLog(`${pet.name}è‡ªå·±ç©è€ï¼ˆå¿«æ¨‚+30ã€ç²¾åŠ›-10ã€æ¸…æ½”-10ã€é£¢é¤“-10ï¼‰`);
            updateStatusBars();
            saveGame();
        }, 3000);
        return;
    }

    // ç²¾åŠ›ä½æ–¼ 20 è‡ªå‹•ç¡è¦º
    if (pet.energy < 20 && !pet.isSleeping) {
        pet.isSleeping = true;
        chicken.classList.add('sleeping');
        randomTalk('sleeping');
        startZzz();
        addLog(`${pet.name}å¤ªç´¯äº†ï¼Œè‡ªå‹•ç¡è¦º`);
        return;
    }

    // ç¡åˆ° 80 è‡ªå‹•èµ·åºŠ
    if (pet.isSleeping && pet.energy >= 80) {
        pet.isSleeping = false;
        chicken.classList.remove('sleeping');
        randomTalk('wake');
        clearZzz();
        pet.happiness = Math.min(100, pet.happiness + 5);
        pet.hunger = Math.max(0, pet.hunger - 5);
        addLog(`${pet.name}ç¡é£½äº†ï¼Œè‡ªå‹•èµ·åºŠï¼ˆå¿«æ¨‚+5ã€é£¢é¤“-5ï¼‰`);
        updateStatusBars();
        saveGame();
    }

    // æ¸…æ½”åº¦æª¢æŸ¥èˆ‡è‡ªå‹•æ¸…æ½”
    if (pet.cleanliness < 50) {
        const cleanPenalty = Math.floor((50 - pet.cleanliness) / 5) * 5;
        pet.happiness = Math.max(0, pet.happiness - cleanPenalty);
        addLog(`${pet.name}å¤ªé«’äº†ï¼Œå¿«æ¨‚åº¦ä¸‹é™ ${cleanPenalty}`);

        if (pet.cleanliness < 30) {
            pet.cleanliness = 100;
            poopContainer.innerHTML = '';
            randomTalk('dirty');
            addLog(`${pet.name}å¤ªé«’ï¼Œè‡ªå‹•æ¸…æ½”å®Œç•¢`);
            updateStatusBars();
            saveGame();
        }
    }
}


        // æª¢æŸ¥éœ€æ±‚ï¼ˆæ¯ 3 ç§’åŸ·è¡Œä¸€æ¬¡ï¼‰
function checkNeeds() {
  if (pet.isDead) return;

  if (pet.hunger < 30) {
    if (Math.random() > 0.5) randomTalk('hungry');
  } else {
    pet.starvationTime = 0;
  }

  if (pet.happiness < 30) {
    if (Math.random() > 0.5) randomTalk('bored');
  }

  if (pet.cleanliness < 30) {
    if (Math.random() > 0.5) randomTalk('dirty');
  }
}

// âœ¨âœ¨âœ¨âœ¨âœ¨ è‡ªå‹•è¡Œç‚ºæ§åˆ¶ END âœ¨âœ¨âœ¨âœ¨âœ¨

// ğŸ’©ğŸ’©ğŸ’©ğŸ’©ğŸ’© å¤§ä¾¿è¡Œç‚ºé‚è¼¯ START ğŸ’©ğŸ’©ğŸ’©ğŸ’©ğŸ’©       
        // å¤§ä¾¿
        function poop() {
            if (pet.isDead || pet.isSleeping || pet.growthStage === 0) return;
            
            // 20%æ©Ÿç‡å¤§ä¾¿
            if (Math.random() > 0.8) {
                const poopElement = document.createElement('div');
                poopElement.className = 'poop';
                
                // å¯µç‰©æ—ä½ç½®
                poopElement.style.left = `${pet.position.x + 50}px`; // åœ¨å¯µç‰©å³é‚Šä¸€é»
                poopElement.style.top = `${pet.position.y + 50}px`;  // åœ¨å¯µç‰©ä¸‹æ–¹ä¸€é»   
                
                poopContainer.appendChild(poopElement);
                
                // æ¸…æ½”åº¦ä¸‹é™20%
                pet.cleanliness = Math.max(0, pet.cleanliness - 20);
                updateStatusBars();
                
                addLog(`${pet.name}å¤§ä¾¿äº†ï¼Œæ¸…æ½”åº¦ä¸‹é™20%`);
                saveGame();
                
                // 10ç§’å¾Œè‡ªå‹•æ¶ˆå¤±
                setTimeout(() => {
                    if (poopElement.parentNode) {
                        poopElement.remove();
                    }
                }, 10000);
            }
        }

// ğŸ’©ğŸ’©ğŸ’©ğŸ’©ğŸ’© å¤§ä¾¿è¡Œç‚ºé‚è¼¯ END ğŸ’©ğŸ’©ğŸ’©ğŸ’©ğŸ’©

// ğŸğŸğŸğŸğŸ é£Ÿç‰©èˆ‡ç©å…·ç”Ÿæˆ START ğŸğŸğŸğŸğŸ
// ç”Ÿæˆé£Ÿç‰©
        function spawnFood() {
            // æ¸…é™¤ç¾æœ‰é£Ÿç‰©
            document.querySelectorAll('.food-item').forEach(item => item.remove());
            
            // éš¨æ©Ÿç”Ÿæˆ1-3å€‹é£Ÿç‰©
            const foodCount = 1 + Math.floor(Math.random() * 2);
            
            for (let i = 0; i < foodCount; i++) {
                const food = foods[Math.floor(Math.random() * foods.length)];
                const foodItem = document.createElement('div');
                foodItem.className = `food-item ${food.color} rounded-full flex items-center justify-center text-xl`;
                foodItem.textContent = food.emoji;
                foodItem.title = food.name;
                
                // éš¨æ©Ÿä½ç½®
                const areaWidth = petArea.clientWidth;
                const areaHeight = petArea.clientHeight;
                const x = 30 + Math.random() * (areaWidth - 60);
                const y = 30 + Math.random() * (areaHeight - 90);
                
                foodItem.style.left = `${x}px`;
                foodItem.style.top = `${y}px`;
                
                // é»æ“Šäº‹ä»¶
                foodItem.addEventListener('click', () => {
                    if (pet.isDead) return;
                    
                    pet.hunger = Math.min(100, pet.hunger + food.restore);
                    updateStatusBars();
                    randomTalk('eating')
                    foodItem.remove();
                    addLog(`${pet.name}åƒäº†${food.name}`);
                    saveGame();
                });
                
                petArea.appendChild(foodItem);
            }
        }

        // ç”Ÿæˆç©å…·
        function spawnToy() {
            // æ¸…é™¤ç¾æœ‰ç©å…·
            document.querySelectorAll('.toy-item').forEach(item => item.remove());
            
            // éš¨æ©Ÿç”Ÿæˆ1å€‹ç©å…·
            const toy = toys[Math.floor(Math.random() * toys.length)];
            const toyItem = document.createElement('div');
            toyItem.className = `toy-item ${toy.color} rounded-full flex items-center justify-center text-xl`;
            toyItem.textContent = toy.emoji;
            toyItem.title = toy.name;
            
            // éš¨æ©Ÿä½ç½®
            const areaWidth = petArea.clientWidth;
            const areaHeight = petArea.clientHeight;
            const x = 30 + Math.random() * (areaWidth - 60);
            const y = 30 + Math.random() * (areaHeight - 90);
            
            toyItem.style.left = `${x}px`;
            toyItem.style.top = `${y}px`;
            
            // é»æ“Šäº‹ä»¶
            toyItem.addEventListener('click', () => {
                if (pet.isDead) return;
                
                pet.happiness = Math.min(100, pet.happiness + toy.restore);
                pet.energy = Math.max(0, pet.energy - 5);
                updateStatusBars();
               randomTalk('playing');
                toyItem.remove();
                addLog(`${pet.name}ç©äº†${toy.name}`);
                saveGame();
            });
            
            petArea.appendChild(toyItem);
        }
// ğŸğŸğŸğŸğŸ é£Ÿç‰©èˆ‡ç©å…·ç”Ÿæˆ END ğŸğŸğŸğŸğŸ

// ğŸ½ï¸ğŸ½ï¸ğŸ½ï¸ğŸ½ï¸ é£Ÿç‰© / ç©å…· / é€ å‹è³‡æ–™å®šç¾©å€ START ğŸ½ï¸ğŸ½ï¸ğŸ½ï¸ğŸ½ï¸
        const foods = [
            { name: 'ç‰ç±³', emoji: 'ğŸŒ½', color: 'bg-yellow-200', restore: 20 },
            { name: 'èŸ²å­', emoji: 'ğŸ›', color: 'bg-green-200', restore: 15 },
            { name: 'ç¨®å­', emoji: 'ğŸŒ±', color: 'bg-brown-200', restore: 10 }
        ];

        const toys = [
            { name: 'çƒ', emoji: 'âš½', color: 'bg-red-200', restore: 15 },
            { name: 'éˆ´éº', emoji: 'ğŸ””', color: 'bg-yellow-200', restore: 10 },
            { name: 'ç¾½æ¯›', emoji: 'ğŸª¶', color: 'bg-white', restore: 20 }
        ];
        // ğŸ’ æ¢éšªçå‹µèƒŒåŒ…é‚è¼¯
let backpack = {};  // èƒŒåŒ…è³‡æ–™ï¼Œä¾‹å¦‚ { "ç¾½æ¯›": 2, "éª¨é ­": 1 }
const dropTable = {
  'å’•å’•æ´ç©´': ['ç¾½æ¯›', 'ç¨®å­', 'è›‹æ®¼'],
  'ç¥ç§˜æ´ç©´': ['æ°´æ™¶', 'éˆé­‚çŸ³', 'æ¯’è‡'],
  'é»‘æš—æ£®æ—': ['éª¨é ­', 'é»‘ç¾½', 'è©›å’’ç¨®å­']
};

// ğŸ½ï¸ğŸ½ï¸ğŸ½ï¸ğŸ½ï¸ é£Ÿç‰© / ç©å…· / é€ å‹è³‡æ–™å®šç¾©å€ END ğŸ½ï¸ğŸ½ï¸ğŸ½ï¸ğŸ½ï¸

function showSpeechBubble(text) {


  speechBubble.textContent = text;
  speechBubble.style.opacity = '1';

  // è¨ˆç®—æ°£æ³¡å¯¬åº¦èˆ‡è¢å¹•é™åˆ¶
  setTimeout(() => {
    const bubbleRect = speechBubble.getBoundingClientRect();
    const containerRect = chickenContainer.getBoundingClientRect();
    const screenWidth = window.innerWidth;

    // æ°£æ³¡è¶…å‡ºå·¦é‚Šç•Œ
    if (bubbleRect.left < 10) {
      const offset = 10 - bubbleRect.left;
      speechBubble.style.left = `calc(50% + ${offset}px)`;
    }

    // æ°£æ³¡è¶…å‡ºå³é‚Šç•Œ
    if (bubbleRect.right > screenWidth - 10) {
      const offset = bubbleRect.right - (screenWidth - 10);
      speechBubble.style.left = `calc(50% - ${offset}px)`;
    }
  }, 10);  // ç­‰å¾… DOM æ›´æ–°ä½ç½®å¾Œå†åˆ¤æ–·

  setTimeout(() => {
    speechBubble.style.opacity = '0';
    speechBubble.style.left = '50%';  // å›åˆ°åŸå§‹ç½®ä¸­ç‹€æ…‹
  }, 5000);
}

 async function randomTalk(type) {

  const now = Date.now();
  if (now - lastTalkTime < talkCooldown) return;
  lastTalkTime = now;

  try {
    const characterName = pet.spriteName;
    const promptUrl = "https://script.google.com/macros/s/AKfycbwqwRG4dE2luydPA5osamt3AMhoh2zNhuOOkXw-fiGj-QR2SDzxK5M_4FP5kDjlti8l/exec?action=getPrompt&name=" + characterName;
    
    const promptRes = await fetch(promptUrl);
    const promptData = await promptRes.json();
    const personalityPrompt = promptData.prompt || "ä½ æ˜¯ä¸€éš»é›»å­å¯µç‰©ï¼Œè«‹æ ¹æ“šæƒ…å¢ƒèªªä¸€å¥è©±ï¼š";
   

    // æ ¹æ“šç•¶ä¸‹ç‹€æ…‹çµ¦ Gemini é¡Œç›®
    const statusMap = {
      hungry: "ä½ ç¾åœ¨è‚šå­å¾ˆé¤“ã€‚",
      tired: "ä½ è¦ºå¾—æœ‰é»ç´¯ã€‚",
      playing: "ä½ æ­£åœ¨ç©è€ã€‚",
      eating: "ä½ æ­£åœ¨åƒæ±è¥¿ã€‚",
      sleeping: "ä½ åœ¨ç¡è¦ºã€‚",
      wake: "ä½ å‰›é†’ä¾†ã€‚",
      bored: "ä½ è¦ºå¾—æœ‰é»ç„¡èŠã€‚",
      dirty: "ä½ è¦ºå¾—èº«ä¸Šé«’é«’çš„ã€‚",
      normal: "ä½ ç›®å‰æ„Ÿè¦ºå¾ˆå¥½ã€‚",
      walk: "ä½ æ­£åœ¨è‡ªç”±èµ°å‹•ã€‚",
      explore: "ä½ æ­£åœ¨å†’éšªæ¢ç´¢ã€‚",
     };
    const statusText = statusMap[type] || "è«‹ä½ èªªä¸€å¥è©±ã€‚";

    // å¤©æ°£æè¿°
    const weatherMap = {
      sunny: "ç¾åœ¨æ˜¯æ™´å¤©ï¼Œé™½å…‰æ™®ç…§ã€‚",
      rainy: "å¤–é¢æ­£åœ¨ä¸‹é›¨ã€‚",
      hot: "å¤©æ°£å¾ˆç‚ç†±ã€‚",
      storm:"æ‰“é›·å•¦ï¼Œæœ‰é»æ€•ã€‚",
      night: "ç¾åœ¨æ˜¯æ™šä¸Šï¼Œå¤©è‰²æ˜æš—ã€‚"
    };
    const weatherText = weatherMap[pet.weather] || "";

    // çµ„åˆæœ€çµ‚æè¿°
    const situation = `${statusText}${weatherText}`;

    const bodyData = {
      contents: [
        {
          parts: [
            { text: personalityPrompt },
            { text: "æƒ…å¢ƒæè¿°ï¼š" + situation }
          ]
        }
      ]
    };

    const geminiUrl = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=" + apiKey;
    const response = await fetch(geminiUrl, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(bodyData)
    });

    const data = await response.json();
    const reply = data.candidates?.[0]?.content?.parts?.[0]?.text;

    if (reply) {
      showSpeechBubble(reply);
    } else {
      throw new Error("Gemini å›å‚³ç©ºå€¼");
    }

  } catch (err) {
    console.warn("âš ï¸ Gemini å¤±æ•—ï¼Œæ”¹ç”¨è©¦ç®—è¡¨è³‡æ–™ï¼š", err);

    // âœ… å‚™æ´æ©Ÿåˆ¶ï¼šæŠ“è©¦ç®—è¡¨è£¡çš„å°è©±å…§å®¹
    if (petSpeech[type] && petSpeech[type].length > 0) {
      const fallbackMsg = petSpeech[type][Math.floor(Math.random() * petSpeech[type].length)];
      showSpeechBubble(fallbackMsg);
    } else {
      showSpeechBubble("......ï¼ˆæ²‰é»˜ï¼‰");
    }
  }
}



function checkEvolution() {
  const possibleEvolutions = evolutionData.filter(evo =>
    evo.evolve_from === pet.spriteName &&
    !isNaN(parseInt(evo.level)) &&
    pet.level >= parseInt(evo.level)
  );

  if (possibleEvolutions.length > 0) {
    let total = 0;
    const weightedList = [];

    for (let evo of possibleEvolutions) {
      const weight = parseFloat(evo.chance) || 0;
      total += weight;
      weightedList.push({ evo, weight: total });
    }

    const rand = Math.random() * total;
    const selected = weightedList.find(e => rand < e.weight).evo;

    // âœ… åŸ·è¡Œé€²åŒ–
    pet.spriteName = selected.name;
    pet.stage = parseInt(selected.stage);
    chicken.style.backgroundImage = `url('${selected.image}')`;
    addLog(`è§’è‰²é€²åŒ–ç‚ºï¼š${selected.name}`);
    saveGame();
  }
}


function updateChickenSprite() {
  if (!evolutionData || evolutionData.length === 0) {
    console.warn("âš ï¸ ç„¡æ³•æ›´æ–°è§’è‰²åœ–ç‰‡ï¼ševolutionData å°šæœªè¼‰å…¥");
    return;
  }

  const matched = evolutionData.find(evo => evo.name === pet.spriteName);
  if (matched && matched.image) {
    chicken.style.backgroundImage = `url('${matched.image}')`;
  } else {
    chicken.style.backgroundImage = `url('https://i.imgur.com/oxsoI8H.png')`; // é è¨­è›‹åœ–
  }
}



function pickEvolutionByChance(evolutions) {
  let total = 0;
  const weighted = [];

  for (let evo of evolutions) {
    const weight = parseFloat(evo["chance"]) || 0;
    total += weight;
    weighted.push({ evo, weight: total });
  }

  const rand = Math.random() * total;
  return weighted.find(e => rand < e.weight).evo;
}







// ğŸ“¦ğŸ“¦ğŸ“¦ğŸ“¦ğŸ“¦ DOM å…ƒç´ å¿«å–å€ START ğŸ“¦ğŸ“¦ğŸ“¦ğŸ“¦ğŸ“¦
        // ğŸ” è§’è‰²ç›¸é—œå…ƒç´ 
const chickenContainer = document.getElementById('chicken-container'); // åŒ…è£¹é›çš„æ•´é«”å®¹å™¨ï¼ˆç”¨æ–¼ç§»å‹•å®šä½ï¼‰
const chicken = document.getElementById('chicken'); // å¯¦éš›é¡¯ç¤ºé›çš„åœ–åƒå…ƒç´ 

// ğŸ’¬ å°è©±æ³¡æ³¡
const speechBubble = document.getElementById('speech-bubble'); // é¡¯ç¤ºå°è©±å…§å®¹çš„æ³¡æ³¡

// ğŸï¸ éŠæˆ²å€åŸŸèˆ‡èƒŒæ™¯
const petArea = document.getElementById('pet-area'); // å¯µç‰©æ´»å‹•çš„ä¸»å€åŸŸï¼ˆèƒŒæ™¯ï¼‰

// ğŸ“Š ç‹€æ…‹æ¢å€å¡Š
const hungerBar = document.getElementById('hunger-bar'); // é£¢é¤“åº¦æ¢
const happinessBar = document.getElementById('happiness-bar'); // å¿«æ¨‚åº¦æ¢
const energyBar = document.getElementById('energy-bar'); // ç²¾åŠ›åº¦æ¢
const cleanlinessBar = document.getElementById('cleanliness-bar'); // æ¸…æ½”åº¦æ¢

// ğŸ“ˆ ç‹€æ…‹æ¢æ•¸å€¼é¡¯ç¤º
const hungerValue = document.getElementById('hunger-value'); // é£¢é¤“æ•¸å€¼
const happinessValue = document.getElementById('happiness-value'); // å¿«æ¨‚æ•¸å€¼
const energyValue = document.getElementById('energy-value'); // ç²¾åŠ›æ•¸å€¼
const cleanlinessValue = document.getElementById('cleanliness-value'); // æ¸…æ½”æ•¸å€¼

// ğŸ§¬ ç­‰ç´šèˆ‡å¹´é½¡é¡¯ç¤º
const levelDisplay = document.getElementById('level'); // ç­‰ç´šé¡¯ç¤º
const statusDisplay = document.getElementById('status'); // ç•¶å‰ç‹€æ…‹ï¼ˆå¦‚ç¡è¦ºä¸­ç­‰ï¼‰

// ğŸ“œ éŠæˆ²æ—¥èªŒ
const log = document.getElementById('log'); // é¡¯ç¤ºéŠæˆ²æ­·ç¨‹è¨˜éŒ„çš„å€å¡Š

// ğŸ½ï¸ æŒ‰éˆ•æ“ä½œï¼šäº’å‹•åŠŸèƒ½
const feedBtn = document.getElementById('feed-btn'); // é¤µé£ŸæŒ‰éˆ•
const playBtn = document.getElementById('play-btn'); // ç©è€æŒ‰éˆ•
const cleanBtn = document.getElementById('clean-btn'); // æ¸…æ½”æŒ‰éˆ•
const sleepBtn = document.getElementById('sleep-btn'); // ç¡è¦ºæŒ‰éˆ•
const renameBtn = document.getElementById('rename-btn'); // æ”¹åæŒ‰éˆ•
const logDrawer = document.getElementById('log-drawer');
const logControls = document.getElementById('log-controls');

// é»æ“ŠæŸ¥çœ‹æ—¥èªŒæŒ‰éˆ•ï¼Œåˆ‡æ› log-open ç‹€æ…‹
document.getElementById('toggle-log-btn').addEventListener('click', () => {
  document.body.classList.toggle('log-open');
  document.body.classList.remove('chat-open'); // ç¢ºä¿èŠå¤©å®¤é—œé–‰
});

// é»æ“ŠèŠå¤©å®¤æŒ‰éˆ•ï¼Œåˆ‡æ› chat-open ç‹€æ…‹
document.getElementById('chat-toggle-btn').addEventListener('click', () => {
  document.body.classList.toggle('chat-open');
  document.body.classList.remove('log-open'); // ç¢ºä¿æ—¥èªŒé—œé–‰
});

// ğŸ“Œ é»æ“ŠèŠå¤©å®¤å…§çš„ã€ŒX æŒ‰éˆ•ã€ï¼Œé—œé–‰èŠå¤©å®¤è¦–çª—
document.getElementById("close-chat-btn").addEventListener("click", () => {
  // â– é—œé–‰èŠå¤©å®¤ï¼Œåªéœ€ç§»é™¤ chat-open class
  document.body.classList.remove("chat-open");
});

document.getElementById('send-btn').addEventListener('click', async function () {
  const input = document.getElementById('chat-input');
  const msg = input.value.trim();
  if (!msg) return;

  const chatBox = document.getElementById('chat-messages');
  chatBox.innerHTML += `<p>ä½ ï¼š${msg}</p>`;
  input.value = '';
  chatBox.scrollTop = chatBox.scrollHeight;

  const thinking = document.createElement('p');
  thinking.textContent = `å¯µç‰©ï¼šæ€è€ƒä¸­...`;
  chatBox.appendChild(thinking);
  chatBox.scrollTop = chatBox.scrollHeight;

  try {
    const characterName = pet.spriteName; // å¯ä»¥æ”¹æˆè®Šæ•¸ later
    const promptUrl = "https://script.google.com/macros/s/AKfycbwqwRG4dE2luydPA5osamt3AMhoh2zNhuOOkXw-fiGj-QR2SDzxK5M_4FP5kDjlti8l/exec?action=getPrompt&name=" + characterName;

    const promptRes = await fetch(promptUrl);
    const promptData = await promptRes.json();
    const petPrompt = promptData.prompt || "ä½ æ˜¯ä¸€éš»å‹å–„çš„é›»å­å¯µç‰©ï¼Œè«‹å›ç­”ä»¥ä¸‹è¨Šæ¯ï¼š";

    const geminiUrl = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=" + apiKey;

    const bodyData = {
      contents: [
        {
          parts: [
            { text: petPrompt },
            { text: "ç©å®¶èªªï¼š" + msg }
          ]
        }
      ]
    };

    const response = await fetch(geminiUrl, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(bodyData)
    });

    const data = await response.json();
    thinking.remove();

    const petReply = data.candidates?.[0]?.content?.parts?.[0]?.text || 'å—¯ï¼Ÿæˆ‘å‰›å‰›æ‰“çŒç¡äº†...å†èªªä¸€æ¬¡å¥½å—ï¼Ÿ';
    chatBox.innerHTML += `<p>å¯µç‰©ï¼š${petReply}</p>`;
    chatBox.scrollTop = chatBox.scrollHeight;

  } catch (error) {
    thinking.remove();
    chatBox.innerHTML += `<p style="color:red">âŒ ç™¼é€å¤±æ•—ï¼š${error.message}</p>`;
    chatBox.scrollTop = chatBox.scrollHeight;
  }
});




// ğŸ’¤ ç¡è¦ºå‹•ç•«
const zzzContainer = document.getElementById('zzz-container'); // å­˜æ”¾ ZZZ å‹•ç•«çš„å°å®¹å™¨

// ğŸ’© å¤§ä¾¿å®¹å™¨
const poopContainer = document.getElementById('poop-container'); // å­˜æ”¾å¯µç‰©å¤§ä¾¿çš„å®¹å™¨

const petNameDisplay = document.getElementById('pet-name-display'); // ä¸»ä»‹é¢ä¸Šé¡¯ç¤ºçš„å¯µç‰©åç¨±

// âœï¸ å‘½å/æ”¹åæ¨¡æ…‹æ¡†
const nameModal = document.getElementById('name-modal'); // å‘½åè¦–çª—
const renameModal = document.getElementById('rename-modal'); // æ”¹åè¦–çª—
const petNameInput = document.getElementById('pet-name-input'); // å‘½åè¼¸å…¥æ¡†
const renameInput = document.getElementById('rename-input'); // æ”¹åè¼¸å…¥æ¡†
const confirmNameBtn = document.getElementById('confirm-name-btn'); // ç¢ºèªå‘½åæŒ‰éˆ•
const confirmRenameBtn = document.getElementById('confirm-rename-btn'); // ç¢ºèªæ”¹åæŒ‰éˆ•


// ğŸ“¦ğŸ“¦ğŸ“¦ğŸ“¦ğŸ“¦ DOM å…ƒç´ å¿«å–å€ END ğŸ“¦ğŸ“¦ğŸ“¦ğŸ“¦ğŸ“¦

function fetchPlayerRecord(playerId) {
  fetch("https://script.google.com/macros/s/AKfycbwqwRG4dE2luydPA5osamt3AMhoh2zNhuOOkXw-fiGj-QR2SDzxK5M_4FP5kDjlti8l/exec?action=getPlayer&playerId=${playerId}")
    .then(response => response.json())
    .then(playerData => {
      if (playerData.error) {
        console.warn("âš ï¸ æ‰¾ä¸åˆ°ç©å®¶è³‡æ–™ï¼Œå¯èƒ½æ˜¯ç¬¬ä¸€æ¬¡ç™»å…¥");
        return;
      }

      Object.assign(pet, playerData);  // âœ… æŠŠè³‡æ–™å¯«å…¥ä½ çš„ pet ç‰©ä»¶
      updateChickenSprite();          // âœ… æ›´æ–°åœ–ç‰‡
      updateStatusBars();             // âœ… æ›´æ–°ç‹€æ…‹æ¢
      updateNameDisplay();            // âœ… æ›´æ–°åç¨±
      console.log("âœ… ç©å®¶è³‡æ–™è¼‰å…¥æˆåŠŸ", playerData);
    })
    .catch(err => {
      console.error("âŒ ç©å®¶è³‡æ–™è¼‰å…¥å¤±æ•—", err);
    });
}


// ğŸ›ŒğŸ›ŒğŸ›ŒğŸ›ŒğŸ›Œ ç¡çœ æ§åˆ¶é‚è¼¯ START ğŸ›ŒğŸ›ŒğŸ›ŒğŸ›ŒğŸ›Œ
        function updateSleepButton() {
            if (pet.isSleeping) {
                sleepBtn.innerHTML = '<i class="fas fa-sun mr-1"></i> å«é†’';
            } else {
                sleepBtn.innerHTML = '<i class="fas fa-moon mr-1"></i> ç¡è¦º';
            }
        }
        // ç¡è¦º/é†’ä¾†
        function toggleSleep() {
            if (pet.isDead) return;
            
            if (pet.isEating || pet.isPlaying) {
               randomTalk('sleeping');  // ç¡è‘—
               randomTalk('wake');      // é†’ä¾† 

                return;
            }
            
            pet.isSleeping = !pet.isSleeping;
            updateSleepButton();
            
            if (pet.isSleeping) {
                chicken.classList.add('sleeping');
               randomTalk('sleeping');  // ç¡è‘—

                addLog(`${pet.name}ç¡è¦ºäº†`);
                
                // é¡¯ç¤ºZZZå‹•ç•«
                startZzz();
            } else {
                chicken.classList.remove('sleeping');
                randomTalk('wake');      // é†’ä¾†
                addLog(`${pet.name}é†’ä¾†äº†`);
                
                // æ¸…é™¤ZZZå‹•ç•«
                clearZzz();
            }
            
            saveGame();
        }

        // é–‹å§‹ZZZå‹•ç•«
        function startZzz() {
            clearZzz();
            zzzContainer.classList.remove('hidden');
            
            // å‰µå»º3å€‹ZZZ
            for (let i = 0; i < 3; i++) {
                const zzz = document.createElement('div');
                zzz.className = 'zzz';
                zzz.textContent = 'Z';
                zzz.style.left = `${i * 10}px`;
                zzz.style.animationDelay = `${i * 0.5}s`;
                zzzContainer.appendChild(zzz);
            }
        }

        // æ¸…é™¤ZZZå‹•ç•«
        function clearZzz() {
            zzzContainer.innerHTML = '';
            zzzContainer.classList.add('hidden');
        }
// ğŸ›ŒğŸ›ŒğŸ›ŒğŸ›ŒğŸ›Œ ç¡çœ æ§åˆ¶é‚è¼¯ END ğŸ›ŒğŸ›ŒğŸ›ŒğŸ›ŒğŸ›Œ
function showBackpack() {
  const backpackModal = document.getElementById('backpack-modal');
  const backpackItems = document.getElementById('backpack-items');
  backpackItems.innerHTML = ''; // æ¸…ç©ºèˆŠå…§å®¹

  if (!backpack || Object.keys(backpack).length === 0) {
    backpackItems.innerHTML = '<p class="col-span-6 text-2xl text-center text-gray-500">ç›®å‰èƒŒåŒ…æ˜¯ç©ºçš„</p>';
    backpackModal.style.display = 'flex';
    return;
  }

  // å±•å¹³æ‰€æœ‰ç‰©å“ç‚ºä¸€æ ¼ä¸€æ ¼ï¼ˆæ¯å€‹æœ€å¤š99ï¼Œè¶…éè¦æ‹†åˆ†æˆå¤šæ ¼ï¼‰
  const slots = [];
  for (const [itemName, count] of Object.entries(backpack)) {
    let remaining = count;
    while (remaining > 0) {
      const stack = Math.min(99, remaining);
      slots.push({ name: itemName, count: stack });
      remaining -= stack;
    }
  }

  // æ¸²æŸ“æ ¼å­ï¼ˆæ¯é 30æ ¼ï¼‰
  const totalSlots = Math.max(slots.length, 30);
  for (let i = 0; i < totalSlots; i++) {
    const slot = slots[i];
    const slotDiv = document.createElement('div');
    slotDiv.className = 'backpack-slot';

    if (slot) {
      slotDiv.textContent = slot.name;
      const countSpan = document.createElement('span');
      countSpan.className = 'item-count';
      countSpan.textContent = slot.count;
      slotDiv.appendChild(countSpan);
    }

    backpackItems.appendChild(slotDiv);
  }

  backpackModal.style.display = 'flex';
}

function saveToSheet() {
  const playerId = localStorage.getItem('playerId');
  if (!playerId) return;

  const data = {
    playerId: playerId,
    petName: pet.name,
    spriteName: pet.spriteName,
    level: pet.level,
    exp: pet.exp,
    coins: pet.coins || 0, // å¦‚æœæ²’ coins å±¬æ€§å°±è¨­ 0
    hunger: pet.hunger,
    happy: pet.happiness, // é€™é‚Šä½ çš„æ¬„ä½æ˜¯ happyï¼Œä¸æ˜¯ happiness
    energy: pet.energy,
    clean: pet.cleanliness, // clean å°æ‡‰ cleanliness
    isSick: pet.isSick || false, // é è¨­ç‚º false
    weather: pet.weather || "sunny",
    backpack: JSON.stringify(backpack || {}),
    lastUpdate: new Date().toLocaleString()
  };

  fetch('https://script.google.com/macros/s/AKfycbwqwRG4dE2luydPA5osamt3AMhoh2zNhuOOkXw-fiGj-QR2SDzxK5M_4FP5kDjlti8l/exec?action=savePlayer', {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  })
    .then(res => res.text())
    .then(txt => console.log("âœ… ç©å®¶è³‡æ–™å·²å„²å­˜åˆ°è©¦ç®—è¡¨", txt))
    .catch(err => console.error("âŒ å„²å­˜å¤±æ•—", err));
}


// ğŸ“€ğŸ“€ğŸ“€ğŸ“€ğŸ“€ å„²å­˜èˆ‡è¼‰å…¥åŠŸèƒ½ START ğŸ“€ğŸ“€ğŸ“€ğŸ“€ğŸ“€
     function saveGame() {
  const now = Date.now();
  pet.lastSaveTime = now;

  const gameData = {
    pet: pet,
    logs: Array.from(log.children).map(el => el.textContent).slice(0, 20) // ä¿å­˜æœ€è¿‘çš„20æ¢æ—¥èªŒ
  };

  localStorage.setItem('virtualPetChicken', JSON.stringify(gameData));

  // âœ… åŒæ­¥å„²å­˜åˆ° Google è©¦ç®—è¡¨
  saveToSheet();
}
        // åŠ è¼‰éŠæˆ²
        function loadGame() {
            const savedData = localStorage.getItem('virtualPetChicken');
            if (savedData) {
                try {
                    const gameData = JSON.parse(savedData);
                    
                    // æ¢å¾©å¯µç‰©ç‹€æ…‹
                    Object.assign(pet, gameData.pet);
                    updateChickenSprite(); // âœ… åŠ é€™ä¸€è¡Œï¼Œæ ¹æ“š spriteName å¥—ç”¨å°æ‡‰è§’è‰²åœ–ç‰‡
                    
                    // æ¢å¾©æ—¥èªŒ
                    log.innerHTML = '';
                    if (gameData.logs && gameData.logs.length > 0) {
                        gameData.logs.forEach(msg => {
                            const logEntry = document.createElement('p');
                            logEntry.textContent = msg;
                            log.appendChild(logEntry);
                        });
                    } else {
                        addLog("æ­¡è¿å›ä¾†ï¼");
                    }
                    
                    // è¨ˆç®—é›¢ç·šæ™‚é–“
                    const offlineTime = Date.now() - pet.lastSaveTime;
                    if (offlineTime > 60000) { // è¶…é1åˆ†é˜æ‰è¨ˆç®—
                        const offlineHours = Math.floor(offlineTime / 3600000);
                        const offlineMinutes = Math.floor((offlineTime % 3600000) / 60000);
                        
                        if (offlineHours > 0 || offlineMinutes > 0) {
                            addLog(`ä½ é›¢é–‹äº† ${offlineHours > 0 ? offlineHours + 'å°æ™‚' : ''}${offlineMinutes}åˆ†é˜`);
                        }
                    }
                    
                    // æ ¹æ“šé›¢ç·šæ™‚é–“æ›´æ–°ç‹€æ…‹
                    updateOfflineStatus(offlineTime);
                    
                } catch (e) {
                    console.error("åŠ è¼‰éŠæˆ²å¤±æ•—:", e);
                    addLog("åŠ è¼‰ä¿å­˜çš„éŠæˆ²å¤±æ•—ï¼Œé–‹å§‹æ–°éŠæˆ²");
                    localStorage.removeItem('virtualPetChicken'); // ç§»é™¤å£è³‡æ–™é¿å…ä¸‹æ¬¡å†è·³éŒ¯
                }
            }
        }
        // æ›´æ–°é›¢ç·šç‹€æ…‹
        function updateOfflineStatus(offlineTime) {
            if (pet.isDead) return;
            
            const hoursOffline = offlineTime / 3600000;
            const minutesOffline = offlineTime / 60000;
            
            // é£¢é¤“åº¦ä¸‹é™ (æ¯10åˆ†é˜ä¸‹é™1%)
            const hungerDecrease = Math.min(100, Math.floor(minutesOffline / 10));
            pet.hunger = Math.max(0, pet.hunger - hungerDecrease);
            
            // å¿«æ¨‚åº¦ä¸‹é™ (æ¯å°æ™‚ä¸‹é™5%)
            const happinessDecrease = Math.min(100, Math.floor(hoursOffline * 5));
            pet.happiness = Math.max(0, pet.happiness - happinessDecrease);
            
            // ç²¾åŠ›è®ŠåŒ– (ç¡è¦ºæ™‚æ¢å¾©ï¼Œå¦å‰‡ä¸‹é™)
            if (pet.isSleeping) {
                const energyIncrease = Math.min(100, Math.floor(minutesOffline * 0.5)); // æ¯åˆ†é˜æ¢å¾©0.5%
                pet.energy = Math.min(100, pet.energy + energyIncrease);
            } else {
                const energyDecrease = Math.min(100, Math.floor(minutesOffline / 15)); // æ¯15åˆ†é˜ä¸‹é™1%
                pet.energy = Math.max(0, pet.energy - energyDecrease);
            }
            
            // æ¸…æ½”åº¦ä¸‹é™ (æ¯20åˆ†é˜ä¸‹é™1%)
            const cleanlinessDecrease = Math.min(100, Math.floor(minutesOffline / 20));
            pet.cleanliness = Math.max(0, pet.cleanliness - cleanlinessDecrease);
            
            
            updateStatusBars();
        }       
        
 // ğŸ“€ğŸ“€ğŸ“€ğŸ“€ğŸ“€ å„²å­˜èˆ‡è¼‰å…¥åŠŸèƒ½ END ğŸ“€ğŸ“€ğŸ“€ğŸ“€ğŸ“€

      


// ğŸ”ğŸ”ğŸ”ğŸ”ğŸ” æˆé•·èˆ‡é‚è¼¯ START ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”      
        // å¹´é½¡å¢é•·
        function agePet() {
            if (pet.isDead) return;
            
            pet.age++;
            
            // æª¢æŸ¥æ˜¯å¦æˆé•·
            if (pet.age === 1 && pet.growthStage === 0) {
                // å­µåŒ–
                pet.growthStage = 1;
                updateChickenSprite();
               randomTalk('wake')

                addLog(`é›è›‹å­µåŒ–äº†ï¼${pet.name}èª•ç”Ÿäº†ï¼`);
            } else if (pet.age === 3 && pet.growthStage === 1) {
                // é•·å¤§
                pet.growthStage = 2;
                updateChickenSprite();
               randomTalk('walk')

                addLog(`${pet.name}é•·æˆäº†ä¸€éš»æˆå¹´é›ï¼`);
            } else if (pet.age % 7 === 0 && pet.growthStage === 2) {
                // å‡ç´š
                pet.level++;
                randomTalk('walk')

                addLog(`${pet.name}å‡ç´šäº†ï¼ç¾åœ¨æ˜¯ç­‰ç´š ${pet.level}`);
            }
            
            updateStatusBars();
            saveGame();
        }
// ğŸ”ğŸ”ğŸ”ğŸ”ğŸ” æˆé•·èˆ‡é‚è¼¯ END ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”

function gainExp(amount) {
  pet.exp += amount;

  while (pet.exp >= pet.maxExp) {
    pet.exp -= pet.maxExp;
    pet.level += 1;
    pet.maxExp = 100 + (pet.level - 1) * 50;
    addLog(`å‡ç´šäº†ï¼ç›®å‰ç­‰ç´šï¼š${pet.level}`);
    levelDisplay.textContent = pet.level;
  }

  updateExpRing(pet.exp, pet.maxExp);
  saveGame();
}

function updateExpRing(currentExp, maxExp) {
  const percentage = (currentExp / maxExp) * 100;
  const dash = percentage.toFixed(2);
  const ring = document.getElementById("exp-ring");
  ring.setAttribute("stroke-dasharray", `${dash} 100`);
}



// ğŸ“¢ğŸ“¢ğŸ“¢ğŸ“¢ğŸ“¢ æ—¥èªŒèˆ‡å°è©± START ğŸ“¢ğŸ“¢ğŸ“¢ğŸ“¢ğŸ“¢
 // é¡¯ç¤ºå°è©±æ³¡æ³¡
        // æ·»åŠ æ—¥èªŒ
        function addLog(message) {
            const logEntry = document.createElement('p');
            logEntry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            log.appendChild(logEntry);
            log.scrollTop = log.scrollHeight;
            
            // é™åˆ¶æ—¥èªŒæ•¸é‡
            if (log.children.length > 20) {
                log.removeChild(log.children[0]);
            }
        }
// âœ… æ¢éšªä¸»ç¨‹å¼ï¼šé€²å…¥æ´ç©´
function startExploration(place) {
  document.getElementById('explore-modal').style.display = 'none';
  document.body.classList.add('exploring');
  addLog(`${pet.name} å‰å¾€ ${place} æ¢éšªä¸­...`);

  // âœ… æ”¹é€™ä¸€è¡Œï¼šç”¨ Gemini èªªè©±è€Œä¸æ˜¯è¡¨æ ¼
  randomTalk('explore');

  switch (place) {
    case 'å’•å’•æ´ç©´':
      petArea.style.backgroundImage = "url('https://i.imgur.com/kc15Z8F.png')";
      break;
    case 'ç¥ç§˜æ´ç©´':
      petArea.style.backgroundImage = "url('https://i.imgur.com/pAeHXzQ.png')";
      break;
    case 'é»‘æš—æ£®æ—':
      petArea.style.backgroundImage = "url('https://i.imgur.com/bEyKtwO.png')";
      break;
  }

  petArea.style.backgroundSize = 'cover';
  petArea.style.backgroundPosition = 'center';

  pet.position.x = window.innerWidth / 2;
  pet.position.y = window.innerHeight / 2;
  updatePosition();
  startExplorationMove();
}
// âœ… é—œé–‰æ´ç©´é¸å–®ï¼ˆé‚„æ²’æ¢éšªå‰ï¼‰
function closeExploreModal() {
  document.getElementById('explore-modal').style.display = 'none';
}
// âœ… æ¢éšªçµæŸï¼Œæ¢å¾©åŸç‹€
function endExploration() {
  stopExplorationMove();  // åœæ­¢èµ°å‹•
  const drops = getExploreRewards();  // æ¢éšªæ‰è½
  showRewardModal(drops);  // é¡¯ç¤ºçå‹µæ¨¡æ…‹æ¡†

  // âœ… åœæ­¢å·¦å³ç§»å‹•
  stopExplorationMove();

  // âœ… å›å¾©åŸæœ¬èƒŒæ™¯ï¼ˆæ ¹æ“šå¤©æ°£é‡è¨­ï¼‰
  updateWeather();
}
// âœ… æ¢éšªä¸­çš„è§’è‰²å·¦å³è‡ªå‹•ç§»å‹•
let exploreInterval = null;



function showRewardModal(drops) {
  const modal = document.getElementById('explore-reward-modal');
  const rewardBox = document.getElementById('reward-items');
  rewardBox.innerHTML = drops.map(item => `ğŸ ${item}`).join('<br>');
  modal.style.display = 'flex';
}


function startExplorationMove() {
  if (exploreInterval) return;

  let movingRight = true;
  exploreInterval = setInterval(() => {
    const areaWidth = petArea.clientWidth;

    if (movingRight) {
      pet.direction = 1;
      pet.position.x += 50;
      if (pet.position.x >= areaWidth - 100) movingRight = false;
    } else {
      pet.direction = -1;
      pet.position.x -= 50;
      if (pet.position.x <= 100) movingRight = true;
    }

    chicken.classList.add('walking');
    updatePosition();
    setTimeout(() => chicken.classList.remove('walking'), 400);

    // âœ… æ”¹é€™ä¸€è¡Œï¼šæ”¹æˆ Gemini èªªè©±
    if (Math.random() > 0.5) {
      randomTalk('explore');
    }
  }, 1000);
}


function getExploreRewards() {
  const place = getCurrentExplorePlace();
  const table = dropTable[place] || [];
  const result = [];

  for (let i = 0; i < 2 + Math.floor(Math.random() * 2); i++) {
    const item = table[Math.floor(Math.random() * table.length)];
    result.push(item);
    backpack[item] = Math.min(99, (backpack[item] || 0) + 1);
  }
  return result;
}

function getCurrentExplorePlace() {
  const bg = petArea.style.backgroundImage;
  if (bg.includes("kc15Z8F")) return 'å’•å’•æ´ç©´';
  if (bg.includes("pAeHXzQ")) return 'ç¥ç§˜æ´ç©´';
  if (bg.includes("bEyKtwO")) return 'é»‘æš—æ£®æ—';
  return 'æœªçŸ¥åœ°é»';
}

function showRewardModal(drops) {
  const modal = document.getElementById('explore-reward-modal');
  const rewardBox = document.getElementById('reward-items');
  rewardBox.innerHTML = drops.map(item => `ğŸ ${item}`).join('<br>');
  modal.style.display = 'flex';
}



function stopExplorationMove() {
  clearInterval(exploreInterval);
  exploreInterval = null;
}
function confirmReward() {
  document.getElementById('explore-reward-modal').style.display = 'none';
  updateWeather(); // é‚„åŸèƒŒæ™¯
  document.body.classList.remove('exploring'); // é›¢é–‹æ¢éšªæ¨¡å¼
  addLog(`${pet.name} æŠŠç²å¾—çš„å¯¶ç‰©æ”¾é€²èƒŒåŒ…`);
  gainExp(200000); // æ¢éšªçµæŸå¾Œå¢åŠ  20 ç¶“é©—å€¼ï¼ˆå¯ä¾æƒ…æ³èª¿æ•´ï¼‰
  saveGame();
}
function closeBackpack() {
  document.getElementById('backpack-modal').style.display = 'none';
}


// ğŸ“¢ğŸ“¢ğŸ“¢ğŸ“¢ğŸ“¢ æ—¥èªŒèˆ‡å°è©± END ğŸ“¢ğŸ“¢ğŸ“¢ğŸ“¢ğŸ“¢
        // æ›´æ–°å¯µç‰©ç‹€æ…‹
        function updatePetStatus() {
            if (pet.isDead) return;
            
            const now = Date.now();
            
            // é£¢é¤“åº¦ä¸‹é™ (æ¯10åˆ†é˜ä¸‹é™1%)
            if (now - pet.lastHungerDecrease > 600000) {
                pet.hunger = Math.max(0, pet.hunger - 1);
                pet.lastHungerDecrease = now;
            }
            
            // å¿«æ¨‚åº¦ä¸‹é™
            if (now - pet.lastHappinessDecrease > 5000 && !pet.isSleeping) {
                pet.happiness = Math.max(0, pet.happiness - 1);
                pet.lastHappinessDecrease = now;
            }
            
            // ç²¾åŠ›ä¸‹é™æˆ–æ¢å¾©
            if (pet.isSleeping) {
                if (now - pet.lastEnergyDecrease > 2000) {
                    pet.energy = Math.min(100, pet.energy + 2);
                    pet.lastEnergyDecrease = now;
                }
            } else {
                // æ¯15åˆ†é˜ä¸‹é™1%
                if (now - pet.lastEnergyDecrease > 900000) {
                    pet.energy = Math.max(0, pet.energy - 1);
                    pet.lastEnergyDecrease = now;
                }
            }
            
            // æ¸…æ½”åº¦ä¸‹é™ (æ¯20åˆ†é˜ä¸‹é™1%)
            if (now - pet.lastCleanlinessDecrease > 1200000) {
                pet.cleanliness = Math.max(0, pet.cleanliness - 1);
                pet.lastCleanlinessDecrease = now;
            }
            

            updateStatusBars();
            
            // æ¯5åˆ†é˜è‡ªå‹•ä¿å­˜ä¸€æ¬¡
            if (now - pet.lastSaveTime > 300000) {
                saveGame();
            }
        }

       
// ğŸ§¼ğŸ§¼ğŸ§¼ğŸ§¼ğŸ§¼ ç©å®¶äº’å‹•åŠŸèƒ½å€ START ğŸ§¼ğŸ§¼ğŸ§¼ğŸ§¼ğŸ§¼
        // é¤µé£Ÿ
        function feedPet() {
            if (pet.isDead) return;
            
            if (pet.isSleeping) {
                randomTalk('eating');
                return;
            }
            
            if (pet.isEating) {
                randomTalk('eating');
                return;
            }
            
            pet.isEating = true;
            chicken.classList.add('eating');
            randomTalk('eating');
            
            // ç”Ÿæˆé£Ÿç‰©
            spawnFood();
            
            setTimeout(() => {
                pet.hunger = Math.min(100, pet.hunger + 20);
                pet.isEating = false;
                chicken.classList.remove('eating');
                updateStatusBars();
                addLog(`ä½ é¤µäº†${pet.name}`);
                saveGame();
            }, 2000);
        }

        // ç©è€
        function playWithPet() {
            if (pet.isDead) return;
            
            if (pet.isSleeping) {
               randomTalk('playing');
                return;
            }
            
            if (pet.isPlaying) {
                randomTalk('playing');

                return;
            }
            
            pet.isPlaying = true;
            chicken.classList.add('playing');
            randomTalk('playing');

            
            // ç”Ÿæˆç©å…·
            spawnToy();
            
            setTimeout(() => {
                pet.happiness = Math.min(100, pet.happiness + 20);
                pet.energy = Math.max(0, pet.energy - 3); // æ¯æ¬¡ç©è€æ¸›å°‘3%ç²¾åŠ›
                pet.isPlaying = false;
                chicken.classList.remove('playing');
                updateStatusBars();
                addLog(`ä½ å’Œ${pet.name}ç©è€äº†`);
                saveGame();
            }, 2000);
        }

        // æ¸…æ½”
        function cleanPet() {
            if (pet.isDead) return;
            
            if (pet.isSleeping) {
               randomTalk('dirty');

                return;
            }
            
            randomTalk('dirty');
            pet.cleanliness = 100;
            
            // æ¸…é™¤æ‰€æœ‰å¤§ä¾¿
            poopContainer.innerHTML = '';
            
            updateStatusBars();
            addLog(`ä½ æ¸…æ½”äº†${pet.name}`);
            saveGame();
        }
// ğŸ§¼ğŸ§¼ğŸ§¼ğŸ§¼ğŸ§¼ ç©å®¶äº’å‹•åŠŸèƒ½å€ END ğŸ§¼ğŸ§¼ğŸ§¼ğŸ§¼ğŸ§¼

// ğŸŒ è¼‰å…¥å°è§’è‰²è³‡æ–™
let evolutionData = [];

function loadEvolutionData() {
  fetch("https://script.google.com/macros/s/AKfycbwqwRG4dE2luydPA5osamt3AMhoh2zNhuOOkXw-fiGj-QR2SDzxK5M_4FP5kDjlti8l/exec?action=getEvolution")
    .then(response => response.json())
    .then(data => {
      evolutionData = data;
       console.log("âœ… é€²åŒ–è³‡æ–™å·²è¼‰å…¥", loadEvolutionData);
  })
    .catch(err => console.error("é€²åŒ–è³‡æ–™è¼‰å…¥å¤±æ•—", err));
}


// ğŸŒ è¼‰å…¥å°è©±è³‡æ–™
let petSpeech = {};
fetch("https://script.google.com/macros/s/AKfycbwqwRG4dE2luydPA5osamt3AMhoh2zNhuOOkXw-fiGj-QR2SDzxK5M_4FP5kDjlti8l/exec?action=getPetSpeech")
  .then(response => response.json())
  .then(data => {
    petSpeech = data;
    console.log("âœ… å°è©±å…§å®¹å·²è¼‰å…¥", petSpeech);
  })
  .catch(error => {
    console.error("âŒ è¼‰å…¥èªªè©±è³‡æ–™å¤±æ•—", error);
  });


document.getElementById('login-btn').addEventListener('click', () => {
  const input = document.getElementById('player-id-input');
  const id = input.value.trim();

  if (!id) {
    alert('è«‹è¼¸å…¥ç©å®¶å¸³è™Ÿ');
    return;
  }

  localStorage.setItem('playerId', id);
  document.getElementById('login-modal').style.display = 'none';

  // å¦‚æœè¦é¦¬ä¸Šè¼‰å…¥ç©å®¶è³‡æ–™
  fetchPlayerRecord(id);
});



 // åˆå§‹åŒ–ç¶²é è¼‰å…¥å®Œæˆå¾Œè¦åšçš„äº‹æƒ…
window.onload = () => {
 const playerId = localStorage.getItem('playerId');

  if (!playerId) {
    // â›” æ²’ç™»å…¥ â†’ é¡¯ç¤ºç™»å…¥è¦–çª—
    document.getElementById('login-modal').style.display = 'flex';
    return;
  }

  fetch("https://script.google.com/macros/s/AKfycbwqwRG4dE2luydPA5osamt3AMhoh2zNhuOOkXw-fiGj-QR2SDzxK5M_4FP5kDjlti8l/exec?action=getEvolution")
    .then(response => response.json())
    .then(data => {
      evolutionData = data;
      console.log("âœ… é€²åŒ–è³‡æ–™å·²è¼‰å…¥");
      initPet(); // âœ… è³‡æ–™è¼‰å…¥å¾Œæ‰åˆå§‹åŒ–éŠæˆ²
       fetchPlayerRecord(playerId); // é€™æ˜¯ä½ ç¬¬ 5 æ­¥è¦å¯«çš„å‡½å¼
    })
    
    .catch(err => console.error("é€²åŒ–è³‡æ–™è¼‰å…¥å¤±æ•—", err));
};

document.getElementById('weather-toggle').addEventListener('click', toggleWeather);
updateWeather();

document.getElementById('explore-btn').addEventListener('click', () => {
  if (pet.isDead) return;
  document.getElementById('explore-modal').style.display = 'flex';
});

document.getElementById('end-explore-btn').addEventListener('click', endExploration);

// âœ… é€™è¡Œä¸€å®šè¦åŠ ï¼Œå…ˆæŠ“åˆ°æŒ‰éˆ•
const bagBtn = document.getElementById('bag-btn');

// âœ… é»èƒŒåŒ…æŒ‰éˆ•é¡¯ç¤ºèƒŒåŒ…
bagBtn.addEventListener('click', showBackpack);

// åœ¨é é¢é—œé–‰å‰ä¿å­˜éŠæˆ²
window.addEventListener('beforeunload', () => {
  saveGame();
});

// âœ… é‡ç½®æŒ‰éˆ•
document.getElementById('reset-btn').addEventListener('click', () => {
  if (confirm("ä½ ç¢ºå®šè¦é‡ç½®éŠæˆ²å—ï¼Ÿé€™æœƒæ¸…é™¤æ‰€æœ‰é€²åº¦ï¼")) {
    localStorage.removeItem('virtualPetChicken');

    // é¡¯ç¤º "é‡ç½®ä¸­..."
    document.body.innerHTML = `
      <div style="color: white; background: black; height: 100vh; display: flex; justify-content: center; align-items: center; font-size: 48px;">
        é‡ç½®ä¸­...
      </div>
    `;

    setTimeout(() => {
      // âœ… æ›æˆé‡æ–°å°å‘é¦–é ç¶²å€ï¼ˆä½ çš„ GAS ç¶²å€ï¼‰
      window.location.href = "https://script.google.com/macros/s/AKfycbwqwRG4dE2luydPA5osamt3AMhoh2zNhuOOkXw-fiGj-QR2SDzxK5M_4FP5kDjlti8l/exec";
    }, 500);
  }
});
// âœ… ç™»å…¥æŒ‰éˆ•äº‹ä»¶è™•ç†
document.getElementById('login-confirm-btn').addEventListener('click', () => {
  const input = document.getElementById('player-id-input');
  const playerId = input.value.trim();

  if (!playerId) {
    alert("è«‹è¼¸å…¥å¸³è™Ÿï¼");
    return;
  }

  localStorage.setItem('playerId', playerId);             // âœ… å­˜å…¥æœ¬æ©Ÿå¸³è™Ÿ
  document.getElementById('login-modal').style.display = 'none'; // âœ… é—œé–‰ç™»å…¥è¦–çª—
  window.location.reload();                                // âœ… é‡æ–°è¼‰å…¥ç•«é¢ï¼Œå•Ÿå‹• onload åˆå§‹åŒ–æµç¨‹
});


</script>
<!-- ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§  JavaScript éŠæˆ²é‚è¼¯å€å¡Š   END ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§  --> 
</body>
</html>

